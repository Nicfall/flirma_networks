geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))
ggplot(df.div.sid,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.rad,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. raderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.rad,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. radians")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div,aes(x=spp,y=Observed))+
geom_boxplot()
ggplot(df.div.sid,aes(x=time,y=Observed,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Observed diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.rad,aes(x=time,y=Observed,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. radians")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Observed diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div,aes(x=spp,y=even))+
geom_boxplot()
#rads way more even
wilcox.test(even~spp,data=df.div)
ggplot(df.div.sid,aes(x=time,y=even,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("even diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.rad,aes(x=time,y=even,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. radians")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("even diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.rad,aes(x=time,y=even,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. radians")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Evenness")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.sid,aes(x=time,y=even,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Evenness")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
#I think I'm going with this one:
my.lme <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.sid)
library(nlme)
#I think I'm going with this one:
my.lme <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.sid)
summary(my.lme)
anova(my.lme)
shapiro.test(residuals(my.lme))
#I think I'm going with this one:
lme.shan <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.sid)
summary(lme.shan)
anova(lme.shan)
shapiro.test(residuals(lme.shan))
qqnorm(residuals(lme.shan))
qqline(residuals(lme.shan), col="red")
shapiro.test(residuals(lme.shan))
qqnorm(residuals(lme.shan))
qqline(residuals(lme.shan), col="red")
plot(lme.shan)
qqnorm(my.lme, ~ranef(., level=1)) #one per random level if I understand this site correctly:
##comparing fixed effects vs. random effects
model.fixed = gls(sh.norm ~ time*zone,
data=df.div.sid,
method="REML")
##comparing fixed effects vs. random effects
model.fixed = gls(Shannon ~ time*zone,
data=df.div.sid,
method="REML")
anova(lme.shan,
model.fixed)
### posthoc things ###
emmeans(lme.shan, list(pairwise ~ time), adjust = "none")
library(emmeans)
### posthoc things ###
emmeans(lme.shan, list(pairwise ~ time), adjust = "none")
### posthoc things ###
emmeans(lme.shan, list(pairwise ~ time:zone), adjust = "none")
ggplot(df.div.sid,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
?summarySE()
library("Rmisc")
?summarySE
summarySE(df.div.sid,measurevar="Shannon",groupvars=c("time","site","zone"))
df.div.sid.shan.se <- summarySE(df.div.sid,measurevar="Shannon",groupvars=c("time","site","zone"))
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point()+
theme_cowplot()
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point()+
theme_cowplot()+
geom_errorbar(ymin=Shannon-se,ymax=Shannon+se)
View(df.div.sid.shan.se)
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point()+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se))
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge())+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge())
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.2))+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge())
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5))+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge())
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5))+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5))
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5))+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5))+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5))+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5))+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(0,2,3),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5))+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(0,2,3),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(0,2,3),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(0,2,3),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(0,2,3),name="Site")
?pch
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(22,24,25),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,24,22),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
#geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.sid.shan,position = position_jitterdodge(),alpha=0.5)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. siderea")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.sid.shan,position = position_jitterdodge(),alpha=0.5)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.sid,position = position_jitterdodge(),alpha=0.5)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")
ggplot(df.div.sid.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.sid,position = position_jitterdodge(),alpha=0.3)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")
ggplot(df.div.rad,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. radians")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
### dots & error bars
df.div.rad.shan.se <- summarySE(df.div.rad,measurevar="Shannon",groupvars=c("time","site","zone"))
ggplot(df.div.rad.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.rad,position = position_jitterdodge(),alpha=0.3)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")
shapiro.test(log(df.div.rad$Shannon))
lme.shan.rad <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.rad)
summary(lme.shan.rad)
anova(lme.shan.rad)
shapiro.test(residuals(lme.shan.rad))
qqnorm(reraduals(lme.shan.rad))
qqnorm(residuals(lme.shan.rad))
qqline(residuals(lme.shan), col="red")
qqline(residuals(lme.shan.rad), col="red")
shapiro.test(residuals(lme.shan.rad))
qqnorm(residuals(lme.shan.rad))
qqline(residuals(lme.shan.rad), col="red")
plot(lme.shan.rad)
df.div.rad$sh.norm <- bestNormalize(df.div.rad$Shannon)$x.t
library("bestNormalize")
df.div.rad$sh.norm <- bestNormalize(df.div.rad$Shannon)$x.t
shapiro.test(df.div.rad$sh.norm)
lme.shan.rad <- lme(sh.norm ~ time*zone,
random = ~ 1|site,
data=df.div.rad)
summary(lme.shan.rad)
anova(lme.shan.rad)
shapiro.test(residuals(lme.shan.rad))
qqnorm(residuals(lme.shan.rad))
qqline(residuals(lme.shan.rad), col="red")
plot(lme.shan.rad)
### posthoc things ###
emmeans(lme.shan.rad, list(pairwise ~ time:zone), adjust = "none")
#separate species
df.div.rad1 <- subset(df.div,spp=="srad")
##for rads, taking out UK1 because it makes the stats uneven
df.div.rad <- subset(df.div.rad1,site!="UK1")
ggplot(df.div.rad,aes(x=time,y=Shannon,fill=time,color=time,shape=site))+
geom_jitter(position = position_jitterdodge())+
facet_grid(.~zone)+
geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_fill_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
ggtitle("S. radians")+
scale_shape_manual(values=c(0,2,3),name="Site")+
ylab("Shannon diversity")+
xlab("Time point")+
guides(color="none",fill="none")+
scale_x_discrete(labels=c("Pre","Disturb.","Post"))+
theme(plot.title=element_text(face = "italic"),axis.text.x=element_text(angle=45,vjust=1.1,hjust=1))
### dots & error bars
df.div.rad.shan.se <- summarySE(df.div.rad,measurevar="Shannon",groupvars=c("time","site","zone"))
ggplot(df.div.rad.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.rad,position = position_jitterdodge(),alpha=0.3)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,22,24),name="Site")
shapiro.test(log(df.div.sid$Shannon))
df.div.sid$sh.norm <- bestNormalize(df.div.sid$Shannon)$x.t
shapiro.test(df.div.sid$sh.norm)
#I think I'm going with this one:
lme.shan.sid <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.sid)
summary(lme.shan.sid)
anova(lme.shan.sid)
shapiro.test(log(df.div.sid$Shannon))
shapiro.test(df.div.sid$Shannon)
#I think I'm going with this one:
lme.shan.sid <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.sid)
summary(lme.shan.sid)
anova(lme.shan.sid)
shapiro.test(residuals(lme.shan.sid))
qqnorm(residuals(lme.shan.sid))
qqline(residuals(lme.shan.sid), col="red")
plot(lme.shan.sid)
### posthoc things ###
emmeans(lme.shan.sid, list(pairwise ~ time:zone), adjust = "none")
shapiro.test(log(df.div.rad$Shannon))
shapiro.test(df.div.rad$Shannon)
df.div.rad$sh.norm <- bestNormalize(df.div.rad$Shannon)$x.t
shapiro.test(df.div.rad$sh.norm)
lme.shan.rad <- lme(Shannon ~ time*zone,
random = ~ 1|site,
data=df.div.rad)
summary(lme.shan.rad)
anova(lme.shan.rad)
shapiro.test(residuals(lme.shan.rad))
qqnorm(residuals(lme.shan.rad))
qqline(residuals(lme.shan.rad), col="red")
plot(lme.shan.rad)
### posthoc things ###
emmeans(lme.shan.rad, list(pairwise ~ time:zone), adjust = "none")
ggplot(df.div.rad.shan.se,aes(x=time,y=Shannon,color=time,shape=site))+
geom_jitter(data=df.div.rad,position = position_jitterdodge(),alpha=0.3)+
facet_grid(.~zone)+
geom_errorbar(aes(ymin=Shannon-se,ymax=Shannon+se),position=position_dodge(0.5),width=0.2)+
#geom_boxplot(outlier.shape=NA,color="black",alpha=0.5)+
geom_point(position=position_dodge(0.5),fill="white")+
theme_cowplot()+
scale_color_manual(values=c("#3B0F70","#FA7F53","#A8327D"))+
scale_shape_manual(values=c(25,24),name="Site")
ggplot(df.div,aes(x=spp,y=Observed))+
geom_boxplot()
