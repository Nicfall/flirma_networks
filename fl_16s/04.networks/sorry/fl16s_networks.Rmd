---
title: "fl16s_networks"
author: "Nicola Kriefall"
date: "06/03/2022"
output: html_document
---

# Setup

## Load libraries

```{r libraries}
library("devtools")
library("stringr")
#install_github("zdk123/SpiecEasi")
#library(SpiecEasi)
#library(igraph)
#library(vegan)
#library(Matrix)
#library(reshape2)
#library(plyr)
library(dplyr)
library(gridExtra)
library(grid)
#library(microbiome)
library(phyloseq)

setwd("/Volumes/GoogleDrive/My Drive/Flirma/flirma_networks/fl_16s/04.networks")

#install.packages("beepr")
library(beepr)
```

### Extra function

```{r extra 'not in' function}
#extra function
# load in the following function
'%!in%' <- function(x,y) {
!('%in%'(x,y))
}
# END
```

## Read in & process data

Ran following section once, saved, then skipped other times

```{r, eval=F}
ps.clean <- readRDS("../01.generate_asv_table/ps.cleanest.less.rds")

tax <- as.data.frame(ps.clean@tax_table@.Data)

tax.clean <- data.frame(row.names = row.names(tax),
                        Kingdom = str_replace(tax[,1], "D_0__",""),
                        Phylum = str_replace(tax[,2], "D_1__",""),
                        Class = str_replace(tax[,3], "D_2__",""),
                        Order = str_replace(tax[,4], "D_3__",""),
                        Family = str_replace(tax[,5], "D_4__",""),
                        Genus = str_replace(tax[,6], "D_5__",""),
                        Species = str_replace(tax[,7], "D_6__",""),
                        stringsAsFactors = FALSE)
tax.clean[is.na(tax.clean)] <- ""

for (i in 1:7){ tax.clean[,i] <- as.character(tax.clean[,i])}
####### Fill holes in the tax table
tax.clean[is.na(tax.clean)] <- ""
for (i in 1:nrow(tax.clean)){
  if (tax.clean[i,2] == ""){
    kingdom <- paste("Kingdom_", tax.clean[i,1], sep = "")
    tax.clean[i, 2:7] <- kingdom
  } else if (tax.clean[i,3] == ""){
    phylum <- paste("Phylum_", tax.clean[i,2], sep = "")
    tax.clean[i, 3:7] <- phylum
  } else if (tax.clean[i,4] == ""){
    class <- paste("Class_", tax.clean[i,3], sep = "")
    tax.clean[i, 4:7] <- class
  } else if (tax.clean[i,5] == ""){
    order <- paste("Order_", tax.clean[i,4], sep = "")
    tax.clean[i, 5:7] <- order
  } else if (tax.clean[i,6] == ""){
    family <- paste("Family_", tax.clean[i,5], sep = "")
    tax.clean[i, 6:7] <- family
  } else if (tax.clean[i,7] == ""){
    tax.clean$Species[i] <- paste("Genus",tax.clean$Genus[i], sep = "_")
  }
}

tax_table(ps.clean) <- as.matrix(tax.clean)
```

```{r asv subset}
##ASV LEVEL
ps.clean.sid <- subset_samples(ps.clean,spp=="ssid")
ps.clean.rad <- subset_samples(ps.clean,spp=="srad")

ps.clean.sid.no0 <- prune_taxa(taxa_sums(ps.clean.sid) > 0, ps.clean.sid) 
ps.clean.sid.no0
# phyloseq-class experiment-level object
# otu_table()   OTU Table:          [ 9264 taxa and 166 samples ]:
# sample_data() Sample Data:        [ 166 samples by 11 sample variables ]:
# tax_table()   Taxonomy Table:     [ 9264 taxa by 7 taxonomic ranks ]:
# taxa are columns
ps.clean.rad.no0 <- prune_taxa(taxa_sums(ps.clean.rad) > 0, ps.clean.rad) 
ps.clean.rad.no0
# phyloseq-class experiment-level object
# otu_table()   OTU Table:          [ 10877 taxa and 132 samples ]:
# sample_data() Sample Data:        [ 132 samples by 11 sample variables ]:
# tax_table()   Taxonomy Table:     [ 10877 taxa by 7 taxonomic ranks ]:
# taxa are columns

#saveRDS(ps.clean.sid.no0,file="./files/ps.clean.sid.no0")
#saveRDS(ps.clean.rad.no0,file="./files/ps.clean.rad.no0")
```

```{r re-read asv level files}
ps.clean.sid.no0 <- readRDS("./files/ps.clean.sid.no0")
ps.clean.rad.no0 <- readRDS("./files/ps.clean.rad.no0")
```

```{r family glom, eval=F}
#family
ps.clean.fam <- tax_glom(ps.clean,"Family")

ps.clean.fam.sid <- subset_samples(ps.clean.fam,spp=="ssid")
ps.clean.fam.rad <- subset_samples(ps.clean.fam,spp=="srad")

ps.clean.fam.sid.no0 <- prune_taxa(taxa_sums(ps.clean.fam.sid) > 0, ps.clean.fam.sid)
# otu_table()   OTU Table:         [ 486 taxa and 166 samples ]
# sample_data() Sample Data:       [ 166 samples by 11 sample variables ]
# tax_table()   Taxonomy Table:    [ 486 taxa by 7 taxonomic ranks ]
ps.clean.fam.rad.no0 <- prune_taxa(taxa_sums(ps.clean.fam.rad) > 0, ps.clean.fam.rad)
# otu_table()   OTU Table:         [ 483 taxa and 132 samples ]
# sample_data() Sample Data:       [ 132 samples by 11 sample variables ]
# tax_table()   Taxonomy Table:    [ 483 taxa by 7 taxonomic ranks ]

saveRDS(ps.clean.fam.sid.no0,file="./files/ps.clean.fam.sid.no0")
saveRDS(ps.clean.fam.rad.no0,file="./files/ps.clean.fam.rad.no0")
```

```{r re-read asv level files}
ps.clean.fam.sid.no0 <- readRDS("./files/ps.clean.fam.sid.no0")
ps.clean.fam.rad.no0 <- readRDS("./files/ps.clean.fam.rad.no0")
```

## Subset for sites/years - ASV LEVEL {.tabset}

### S. siderea

```{r}
#subset by timepoint
ps.sid.pre <- subset_samples(ps.clean.sid.no0,time=="Pre")
ps.sid.irm <- subset_samples(ps.clean.sid.no0,time=="Irma")
ps.sid.pos <- subset_samples(ps.clean.sid.no0,time=="Post")

#within each timepoint, separate by sites
#lower keys 1
ps.sid.pre.lk1 <- subset_samples(ps.sid.pre,site=="LK1")
ps.sid.irm.lk1 <- subset_samples(ps.sid.irm,site=="LK1")
ps.sid.pos.lk1 <- subset_samples(ps.sid.pos,site=="LK1")

#upper keys 1
ps.sid.pre.uk1 <- subset_samples(ps.sid.pre,site=="UK1")
ps.sid.irm.uk1 <- subset_samples(ps.sid.irm,site=="UK1")
ps.sid.pos.uk1 <- subset_samples(ps.sid.pos,site=="UK1")

#upper keys 2
ps.sid.pre.uk2 <- subset_samples(ps.sid.pre,site=="UK2")
ps.sid.irm.uk2 <- subset_samples(ps.sid.irm,site=="UK2")
ps.sid.pos.uk2 <- subset_samples(ps.sid.pos,site=="UK2")

#inshore & offshore
#lower keys 1
ps.sid.pre.lk1.in <- subset_samples(ps.sid.pre.lk1,zone=="Inshore")
ps.sid.pre.lk1.off <- subset_samples(ps.sid.pre.lk1,zone=="Offshore")
ps.sid.irm.lk1.in <- subset_samples(ps.sid.irm.lk1,zone=="Inshore")
ps.sid.irm.lk1.off <- subset_samples(ps.sid.irm.lk1,zone=="Offshore")
ps.sid.pos.lk1.in <- subset_samples(ps.sid.pos.lk1,zone=="Inshore")
ps.sid.pos.lk1.off <- subset_samples(ps.sid.pos.lk1,zone=="Offshore")

#upper keys 1
ps.sid.pre.uk1.in <- subset_samples(ps.sid.pre.uk1,zone=="Inshore")
ps.sid.pre.uk1.off <- subset_samples(ps.sid.pre.uk1,zone=="Offshore")
ps.sid.irm.uk1.in <- subset_samples(ps.sid.irm.uk1,zone=="Inshore")
ps.sid.irm.uk1.off <- subset_samples(ps.sid.irm.uk1,zone=="Offshore")
ps.sid.pos.uk1.in <- subset_samples(ps.sid.pos.uk1,zone=="Inshore")
ps.sid.pos.uk1.off <- subset_samples(ps.sid.pos.uk1,zone=="Offshore")

#upper keys 2
ps.sid.pre.uk2.in <- subset_samples(ps.sid.pre.uk2,zone=="Inshore")
ps.sid.pre.uk2.off <- subset_samples(ps.sid.pre.uk2,zone=="Offshore")
ps.sid.irm.uk2.in <- subset_samples(ps.sid.irm.uk2,zone=="Inshore")
ps.sid.irm.uk2.off <- subset_samples(ps.sid.irm.uk2,zone=="Offshore")
ps.sid.pos.uk2.in <- subset_samples(ps.sid.pos.uk2,zone=="Inshore")
ps.sid.pos.uk2.off <- subset_samples(ps.sid.pos.uk2,zone=="Offshore")

#retrieving seq tables
#lower keys 1
seq.sid.pre.lk1.in <- data.frame(ps.sid.pre.lk1.in@otu_table)
seq.sid.irm.lk1.in <- data.frame(ps.sid.irm.lk1.in@otu_table)
seq.sid.pos.lk1.in <- data.frame(ps.sid.pos.lk1.in@otu_table)

seq.sid.pre.lk1.off <- data.frame(ps.sid.pre.lk1.off@otu_table)
seq.sid.irm.lk1.off <- data.frame(ps.sid.irm.lk1.off@otu_table)
seq.sid.pos.lk1.off <- data.frame(ps.sid.pos.lk1.off@otu_table)

#upper keys 1
seq.sid.pre.uk1.in <- data.frame(ps.sid.pre.uk1.in@otu_table)
seq.sid.irm.uk1.in <- data.frame(ps.sid.irm.uk1.in@otu_table)
seq.sid.pos.uk1.in <- data.frame(ps.sid.pos.uk1.in@otu_table)

seq.sid.pre.uk1.off <- data.frame(ps.sid.pre.uk1.off@otu_table)
seq.sid.irm.uk1.off <- data.frame(ps.sid.irm.uk1.off@otu_table)
seq.sid.pos.uk1.off <- data.frame(ps.sid.pos.uk1.off@otu_table)

#upper keys 2
seq.sid.pre.uk2.in <- data.frame(ps.sid.pre.uk2.in@otu_table)
seq.sid.irm.uk2.in <- data.frame(ps.sid.irm.uk2.in@otu_table)
seq.sid.pos.uk2.in <- data.frame(ps.sid.pos.uk2.in@otu_table)

seq.sid.pre.uk2.off <- data.frame(ps.sid.pre.uk2.off@otu_table)
seq.sid.irm.uk2.off <- data.frame(ps.sid.irm.uk2.off@otu_table)
seq.sid.pos.uk2.off <- data.frame(ps.sid.pos.uk2.off@otu_table)
```

#### Cleaning lower reads

Some data cleaning: authors recommend removing taxa with less than an average of 2 reads per column. 

```{r}
#lower keys 1 inshore
seq.sid.pre.lk1.in.no2 <- seq.sid.pre.lk1.in[,-which(colMeans(seq.sid.pre.lk1.in) <= 2)]
ncol(seq.sid.pre.lk1.in.no2) #743
seq.sid.irm.lk1.in.no2 <- seq.sid.irm.lk1.in[,-which(colMeans(seq.sid.irm.lk1.in) <= 2)]
ncol(seq.sid.irm.lk1.in.no2) #1275
seq.sid.pos.lk1.in.no2 <- seq.sid.pos.lk1.in[,-which(colMeans(seq.sid.pos.lk1.in) <= 2)]
ncol(seq.sid.pos.lk1.in.no2) #581

#lower keys 1 offshore
seq.sid.pre.lk1.off.no2 <- seq.sid.pre.lk1.off[,-which(colMeans(seq.sid.pre.lk1.off) <= 2)]
ncol(seq.sid.pre.lk1.off.no2) #2669
seq.sid.irm.lk1.off.no2 <- seq.sid.irm.lk1.off[,-which(colMeans(seq.sid.irm.lk1.off) <= 2)]
ncol(seq.sid.irm.lk1.off.no2) #873
seq.sid.pos.lk1.off.no2 <- seq.sid.pos.lk1.off[,-which(colMeans(seq.sid.pos.lk1.off) <= 2)]
ncol(seq.sid.pos.lk1.off.no2) #906

#upper keys 1 inshore
seq.sid.pre.uk1.in.no2 <- seq.sid.pre.uk1.in[,-which(colMeans(seq.sid.pre.uk1.in) <= 2)]
ncol(seq.sid.pre.uk1.in.no2) #557
seq.sid.irm.uk1.in.no2 <- seq.sid.irm.uk1.in[,-which(colMeans(seq.sid.irm.uk1.in) <= 2)]
ncol(seq.sid.irm.uk1.in.no2) #1236
seq.sid.pos.uk1.in.no2 <- seq.sid.pos.uk1.in[,-which(colMeans(seq.sid.pos.uk1.in) <= 2)]
ncol(seq.sid.pos.uk1.in.no2) #769

#upper keys 1 offshore
seq.sid.pre.uk1.off.no2 <- seq.sid.pre.uk1.off[,-which(colMeans(seq.sid.pre.uk1.off) <= 2)]
ncol(seq.sid.pre.uk1.off.no2) #920
seq.sid.irm.uk1.off.no2 <- seq.sid.irm.uk1.off[,-which(colMeans(seq.sid.irm.uk1.off) <= 2)]
ncol(seq.sid.irm.uk1.off.no2) #1017
seq.sid.pos.uk1.off.no2 <- seq.sid.pos.uk1.off[,-which(colMeans(seq.sid.pos.uk1.off) <= 2)]
ncol(seq.sid.pos.uk1.off.no2) #647

#upper keys 1 inshore
seq.sid.pre.uk2.in.no2 <- seq.sid.pre.uk2.in[,-which(colMeans(seq.sid.pre.uk2.in) <= 2)]
ncol(seq.sid.pre.uk2.in.no2) #535
seq.sid.irm.uk2.in.no2 <- seq.sid.irm.uk2.in[,-which(colMeans(seq.sid.irm.uk2.in) <= 2)]
ncol(seq.sid.irm.uk2.in.no2) #860
seq.sid.pos.uk2.in.no2 <- seq.sid.pos.uk2.in[,-which(colMeans(seq.sid.pos.uk2.in) <= 2)]
ncol(seq.sid.pos.uk2.in.no2) #1176

#upper keys 2 offshore
seq.sid.pre.uk2.off.no2 <- seq.sid.pre.uk2.off[,-which(colMeans(seq.sid.pre.uk2.off) <= 2)]
ncol(seq.sid.pre.uk2.off.no2) #1034
seq.sid.irm.uk2.off.no2 <- seq.sid.irm.uk2.off[,-which(colMeans(seq.sid.irm.uk2.off) <= 2)]
ncol(seq.sid.irm.uk2.off.no2) #1560
seq.sid.pos.uk2.off.no2 <- seq.sid.pos.uk2.off[,-which(colMeans(seq.sid.pos.uk2.off) <= 2)]
ncol(seq.sid.pos.uk2.off.no2) #563
```

### S. radians

```{r}
#subset by timepoint
ps.rad.pre <- subset_samples(ps.clean.rad.no0,time=="Pre")
ps.rad.irm <- subset_samples(ps.clean.rad.no0,time=="Irma")
ps.rad.pos <- subset_samples(ps.clean.rad.no0,time=="Post")

#within each timepoint, separate by sites
#lower keys 1
ps.rad.pre.lk1 <- subset_samples(ps.rad.pre,site=="LK1")
ps.rad.irm.lk1 <- subset_samples(ps.rad.irm,site=="LK1")
ps.rad.pos.lk1 <- subset_samples(ps.rad.pos,site=="LK1")

#upper keys 1
ps.rad.pre.uk1 <- subset_samples(ps.rad.pre,site=="UK1")
ps.rad.irm.uk1 <- subset_samples(ps.rad.irm,site=="UK1")
ps.rad.pos.uk1 <- subset_samples(ps.rad.pos,site=="UK1")

#upper keys 2
ps.rad.pre.uk2 <- subset_samples(ps.rad.pre,site=="UK2")
ps.rad.irm.uk2 <- subset_samples(ps.rad.irm,site=="UK2")
ps.rad.pos.uk2 <- subset_samples(ps.rad.pos,site=="UK2")

#inshore & offshore
#lower keys 1
ps.rad.pre.lk1.in <- subset_samples(ps.rad.pre.lk1,zone=="Inshore")
ps.rad.pre.lk1.off <- subset_samples(ps.rad.pre.lk1,zone=="Offshore")
ps.rad.irm.lk1.in <- subset_samples(ps.rad.irm.lk1,zone=="Inshore")
ps.rad.irm.lk1.off <- subset_samples(ps.rad.irm.lk1,zone=="Offshore")
ps.rad.pos.lk1.in <- subset_samples(ps.rad.pos.lk1,zone=="Inshore")
ps.rad.pos.lk1.off <- subset_samples(ps.rad.pos.lk1,zone=="Offshore")

#upper keys 1
ps.rad.pre.uk1.in <- subset_samples(ps.rad.pre.uk1,zone=="Inshore")
ps.rad.pre.uk1.off <- subset_samples(ps.rad.pre.uk1,zone=="Offshore")
ps.rad.irm.uk1.in <- subset_samples(ps.rad.irm.uk1,zone=="Inshore")
ps.rad.irm.uk1.off <- subset_samples(ps.rad.irm.uk1,zone=="Offshore")
ps.rad.pos.uk1.in <- subset_samples(ps.rad.pos.uk1,zone=="Inshore")
ps.rad.pos.uk1.off <- subset_samples(ps.rad.pos.uk1,zone=="Offshore")

#upper keys 2
ps.rad.pre.uk2.in <- subset_samples(ps.rad.pre.uk2,zone=="Inshore")
ps.rad.pre.uk2.off <- subset_samples(ps.rad.pre.uk2,zone=="Offshore")
ps.rad.irm.uk2.in <- subset_samples(ps.rad.irm.uk2,zone=="Inshore")
ps.rad.irm.uk2.off <- subset_samples(ps.rad.irm.uk2,zone=="Offshore")
ps.rad.pos.uk2.in <- subset_samples(ps.rad.pos.uk2,zone=="Inshore")
ps.rad.pos.uk2.off <- subset_samples(ps.rad.pos.uk2,zone=="Offshore")

#retrieving seq tables
#lower keys 1
seq.rad.pre.lk1.in <- data.frame(ps.rad.pre.lk1.in@otu_table)
seq.rad.irm.lk1.in <- data.frame(ps.rad.irm.lk1.in@otu_table)
seq.rad.pos.lk1.in <- data.frame(ps.rad.pos.lk1.in@otu_table)

seq.rad.pre.lk1.off <- data.frame(ps.rad.pre.lk1.off@otu_table)
seq.rad.irm.lk1.off <- data.frame(ps.rad.irm.lk1.off@otu_table)
seq.rad.pos.lk1.off <- data.frame(ps.rad.pos.lk1.off@otu_table)

#upper keys 1
seq.rad.pre.uk1.in <- data.frame(ps.rad.pre.uk1.in@otu_table)
seq.rad.irm.uk1.in <- data.frame(ps.rad.irm.uk1.in@otu_table)
seq.rad.pos.uk1.in <- data.frame(ps.rad.pos.uk1.in@otu_table)

seq.rad.pre.uk1.off <- data.frame(ps.rad.pre.uk1.off@otu_table)
seq.rad.irm.uk1.off <- data.frame(ps.rad.irm.uk1.off@otu_table)
seq.rad.pos.uk1.off <- data.frame(ps.rad.pos.uk1.off@otu_table)

#upper keys 2
seq.rad.pre.uk2.in <- data.frame(ps.rad.pre.uk2.in@otu_table)
seq.rad.irm.uk2.in <- data.frame(ps.rad.irm.uk2.in@otu_table)
seq.rad.pos.uk2.in <- data.frame(ps.rad.pos.uk2.in@otu_table)

seq.rad.pre.uk2.off <- data.frame(ps.rad.pre.uk2.off@otu_table)
seq.rad.irm.uk2.off <- data.frame(ps.rad.irm.uk2.off@otu_table)
seq.rad.pos.uk2.off <- data.frame(ps.rad.pos.uk2.off@otu_table)
```

#### Cleaning lower reads

Some data cleaning: authors recommend removing taxa with less than an average of 2 reads per column. 

```{r}
#lower keys 1 inshore
seq.rad.pre.lk1.in.no2 <- seq.rad.pre.lk1.in[,-which(colMeans(seq.rad.pre.lk1.in) <= 2)]
ncol(seq.rad.pre.lk1.in.no2) #743
seq.rad.irm.lk1.in.no2 <- seq.rad.irm.lk1.in[,-which(colMeans(seq.rad.irm.lk1.in) <= 2)]
ncol(seq.rad.irm.lk1.in.no2) #1275
seq.rad.pos.lk1.in.no2 <- seq.rad.pos.lk1.in[,-which(colMeans(seq.rad.pos.lk1.in) <= 2)]
ncol(seq.rad.pos.lk1.in.no2) #581

#lower keys 1 offshore
seq.rad.pre.lk1.off.no2 <- seq.rad.pre.lk1.off[,-which(colMeans(seq.rad.pre.lk1.off) <= 2)]
ncol(seq.rad.pre.lk1.off.no2) #2669
seq.rad.irm.lk1.off.no2 <- seq.rad.irm.lk1.off[,-which(colMeans(seq.rad.irm.lk1.off) <= 2)]
ncol(seq.rad.irm.lk1.off.no2) #873
seq.rad.pos.lk1.off.no2 <- seq.rad.pos.lk1.off[,-which(colMeans(seq.rad.pos.lk1.off) <= 2)]
ncol(seq.rad.pos.lk1.off.no2) #906

#upper keys 1 inshore
seq.rad.pre.uk1.in.no2 <- seq.rad.pre.uk1.in[,-which(colMeans(seq.rad.pre.uk1.in) <= 2)]
ncol(seq.rad.pre.uk1.in.no2) #557
seq.rad.irm.uk1.in.no2 <- seq.rad.irm.uk1.in[,-which(colMeans(seq.rad.irm.uk1.in) <= 2)]
ncol(seq.rad.irm.uk1.in.no2) #1236
seq.rad.pos.uk1.in.no2 <- seq.rad.pos.uk1.in[,-which(colMeans(seq.rad.pos.uk1.in) <= 2)]
ncol(seq.rad.pos.uk1.in.no2) #769

#upper keys 1 offshore
seq.rad.pre.uk1.off.no2 <- seq.rad.pre.uk1.off[,-which(colMeans(seq.rad.pre.uk1.off) <= 2)]
ncol(seq.rad.pre.uk1.off.no2) #920
seq.rad.irm.uk1.off.no2 <- seq.rad.irm.uk1.off[,-which(colMeans(seq.rad.irm.uk1.off) <= 2)]
ncol(seq.rad.irm.uk1.off.no2) #1017
seq.rad.pos.uk1.off.no2 <- seq.rad.pos.uk1.off[,-which(colMeans(seq.rad.pos.uk1.off) <= 2)]
ncol(seq.rad.pos.uk1.off.no2) #647

#upper keys 1 inshore
seq.rad.pre.uk2.in.no2 <- seq.rad.pre.uk2.in[,-which(colMeans(seq.rad.pre.uk2.in) <= 2)]
ncol(seq.rad.pre.uk2.in.no2) #535
seq.rad.irm.uk2.in.no2 <- seq.rad.irm.uk2.in[,-which(colMeans(seq.rad.irm.uk2.in) <= 2)]
ncol(seq.rad.irm.uk2.in.no2) #860
seq.rad.pos.uk2.in.no2 <- seq.rad.pos.uk2.in[,-which(colMeans(seq.rad.pos.uk2.in) <= 2)]
ncol(seq.rad.pos.uk2.in.no2) #1176

#upper keys 2 offshore
seq.rad.pre.uk2.off.no2 <- seq.rad.pre.uk2.off[,-which(colMeans(seq.rad.pre.uk2.off) <= 2)]
ncol(seq.rad.pre.uk2.off.no2) #1034
seq.rad.irm.uk2.off.no2 <- seq.rad.irm.uk2.off[,-which(colMeans(seq.rad.irm.uk2.off) <= 2)]
ncol(seq.rad.irm.uk2.off.no2) #1560
seq.rad.pos.uk2.off.no2 <- seq.rad.pos.uk2.off[,-which(colMeans(seq.rad.pos.uk2.off) <= 2)]
ncol(seq.rad.pos.uk2.off.no2) #563
```

# Networks

## Setup

Begin by installing & loading necessary packages.

(Overall pipeline & scripts followed is sourced from [here; Layeghifard *et al*., 2018, *Methods in Molecular Biology*](https://www-ncbi-nlm-nih-gov.ezproxy.bu.edu/pubmed/30298259))

```{r packages, message=FALSE}
# Install Required packages 
#install.packages("igraph") 
library("igraph")
#install.packages("qgraph") 
library("qgraph")
#install.packages("MCL")
library("MCL")
#install.packages("vegan")
library("vegan")
# Install SpiecEasi package 
#install.packages("devtools") 
library("devtools") 
#install_github("zdk123/SpiecEasi")
library("SpiecEasi")
library("ggplot2")
library("ggpubr")
library("network")
#devtools::install_github("briatte/ggnet")
library(ggnet)
```

## Building adjacency matrix & network - ASV

### S. siderea

Building an adjacency matrix of correlations of the abundances of bacterial ASVs

```{r build network}
# SparCC network
#lower keys 1
spar.sid.pre.lk1i <- sparcc(seq.sid.pre.lk1.in.no2)
spar.sid.pre.lk1o <- sparcc(seq.sid.pre.lk1.off.no2)

spar.sid.irm.lk1i <- sparcc(seq.sid.irm.lk1.in.no2)
spar.sid.irm.lk1o <- sparcc(seq.sid.irm.lk1.off.no2)

spar.sid.pos.lk1i <- sparcc(seq.sid.pos.lk1.in.no2)
spar.sid.pos.lk1o <- sparcc(seq.sid.pos.lk1.off.no2)

#upper keys 1
spar.sid.pre.uk1i <- sparcc(seq.sid.pre.uk1.in.no2)
spar.sid.pre.uk1o <- sparcc(seq.sid.pre.uk1.off.no2)

spar.sid.irm.uk1i <- sparcc(seq.sid.irm.uk1.in.no2)
spar.sid.irm.uk1o <- sparcc(seq.sid.irm.uk1.off.no2)

spar.sid.pos.uk1i <- sparcc(seq.sid.pos.uk1.in.no2)
spar.sid.pos.uk1o <- sparcc(seq.sid.pos.uk1.off.no2)

#upper keys 2
spar.sid.pre.uk2i <- sparcc(seq.sid.pre.uk2.in.no2)
spar.sid.pre.uk2o <- sparcc(seq.sid.pre.uk2.off.no2)

spar.sid.irm.uk2i <- sparcc(seq.sid.irm.uk2.in.no2)
spar.sid.irm.uk2o <- sparcc(seq.sid.irm.uk2.off.no2)

spar.sid.pos.uk2i <- sparcc(seq.sid.pos.uk2.in.no2)
spar.sid.pos.uk2o <- sparcc(seq.sid.pos.uk2.off.no2)

sparcc.cutoff <- 0.7

#lower keys 1
adj.sid.pre.lk1i <- ifelse(abs(spar.sid.pre.lk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.pre.lk1o <- ifelse(abs(spar.sid.pre.lk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.sid.irm.lk1i <- ifelse(abs(spar.sid.irm.lk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.irm.lk1o <- ifelse(abs(spar.sid.irm.lk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.sid.pos.lk1i <- ifelse(abs(spar.sid.pos.lk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.pos.lk1o <- ifelse(abs(spar.sid.pos.lk1o$Cor) >= sparcc.cutoff, 1, 0)

#upper keys 1
adj.sid.pre.uk1i <- ifelse(abs(spar.sid.pre.uk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.pre.uk1o <- ifelse(abs(spar.sid.pre.uk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.sid.irm.uk1i <- ifelse(abs(spar.sid.irm.uk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.irm.uk1o <- ifelse(abs(spar.sid.irm.uk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.sid.pos.uk1i <- ifelse(abs(spar.sid.pos.uk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.pos.uk1o <- ifelse(abs(spar.sid.pos.uk1o$Cor) >= sparcc.cutoff, 1, 0)

#upper keys 2
adj.sid.pre.uk2i <- ifelse(abs(spar.sid.pre.uk2i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.pre.uk2o <- ifelse(abs(spar.sid.pre.uk2o$Cor) >= sparcc.cutoff, 1, 0)

adj.sid.irm.uk2i <- ifelse(abs(spar.sid.irm.uk2i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.irm.uk2o <- ifelse(abs(spar.sid.irm.uk2o$Cor) >= sparcc.cutoff, 1, 0)

adj.sid.pos.uk2i <- ifelse(abs(spar.sid.pos.uk2i$Cor) >= sparcc.cutoff, 1, 0)
adj.sid.pos.uk2o <- ifelse(abs(spar.sid.pos.uk2o$Cor) >= sparcc.cutoff, 1, 0)

# Add names to rows and columns
#lower keys 1 inshore
rownames(adj.sid.pre.lk1i) <- colnames(seq.sid.pre.lk1.in.no2)
colnames(adj.sid.pre.lk1i) <- colnames(seq.sid.pre.lk1.in.no2) 

rownames(adj.sid.irm.lk1i) <- colnames(seq.sid.irm.lk1.in.no2)
colnames(adj.sid.irm.lk1i) <- colnames(seq.sid.irm.lk1.in.no2) 

rownames(adj.sid.pos.lk1i) <- colnames(seq.sid.pos.lk1.in.no2)
colnames(adj.sid.pos.lk1i) <- colnames(seq.sid.pos.lk1.in.no2) 

#lower keys 1 offshore
rownames(adj.sid.pre.lk1o) <- colnames(seq.sid.pre.lk1.off.no2)
colnames(adj.sid.pre.lk1o) <- colnames(seq.sid.pre.lk1.off.no2) 

rownames(adj.sid.irm.lk1o) <- colnames(seq.sid.irm.lk1.off.no2)
colnames(adj.sid.irm.lk1o) <- colnames(seq.sid.irm.lk1.off.no2) 

rownames(adj.sid.pos.lk1o) <- colnames(seq.sid.pos.lk1.off.no2)
colnames(adj.sid.pos.lk1o) <- colnames(seq.sid.pos.lk1.off.no2) 

#upper keys 1 inshore
rownames(adj.sid.pre.uk1i) <- colnames(seq.sid.pre.uk1.in.no2)
colnames(adj.sid.pre.uk1i) <- colnames(seq.sid.pre.uk1.in.no2) 

rownames(adj.sid.irm.uk1i) <- colnames(seq.sid.irm.uk1.in.no2)
colnames(adj.sid.irm.uk1i) <- colnames(seq.sid.irm.uk1.in.no2) 

rownames(adj.sid.pos.uk1i) <- colnames(seq.sid.pos.uk1.in.no2)
colnames(adj.sid.pos.uk1i) <- colnames(seq.sid.pos.uk1.in.no2) 

#upper keys 1 offshore
rownames(adj.sid.pre.uk1o) <- colnames(seq.sid.pre.uk1.off.no2)
colnames(adj.sid.pre.uk1o) <- colnames(seq.sid.pre.uk1.off.no2) 

rownames(adj.sid.irm.uk1o) <- colnames(seq.sid.irm.uk1.off.no2)
colnames(adj.sid.irm.uk1o) <- colnames(seq.sid.irm.uk1.off.no2) 

rownames(adj.sid.pos.uk1o) <- colnames(seq.sid.pos.uk1.off.no2)
colnames(adj.sid.pos.uk1o) <- colnames(seq.sid.pos.uk1.off.no2) 

#upper keys 2 inshore
rownames(adj.sid.pre.uk2i) <- colnames(seq.sid.pre.uk2.in.no2)
colnames(adj.sid.pre.uk2i) <- colnames(seq.sid.pre.uk2.in.no2) 

rownames(adj.sid.irm.uk2i) <- colnames(seq.sid.irm.uk2.in.no2)
colnames(adj.sid.irm.uk2i) <- colnames(seq.sid.irm.uk2.in.no2) 

rownames(adj.sid.pos.uk2i) <- colnames(seq.sid.pos.uk2.in.no2)
colnames(adj.sid.pos.uk2i) <- colnames(seq.sid.pos.uk2.in.no2) 

#upper keys 2 offshore
rownames(adj.sid.pre.uk2o) <- colnames(seq.sid.pre.uk2.off.no2)
colnames(adj.sid.pre.uk2o) <- colnames(seq.sid.pre.uk2.off.no2) 

rownames(adj.sid.irm.uk2o) <- colnames(seq.sid.irm.uk2.off.no2)
colnames(adj.sid.irm.uk2o) <- colnames(seq.sid.irm.uk2.off.no2) 

rownames(adj.sid.pos.uk2o) <- colnames(seq.sid.pos.uk2.off.no2)
colnames(adj.sid.pos.uk2o) <- colnames(seq.sid.pos.uk2.off.no2) 
```

Saving everything

```{r, eval=F}
#sequence tables, cleaned
#lower keys 1
saveRDS(seq.sid.pre.lk1.in.no2,file="./files/seq.tables/seq.sid.pre.lk1.in.no2.rds")
saveRDS(seq.sid.pre.lk1.off.no2,file="./files/seq.tables/seq.sid.pre.lk1.off.no2.rds")

saveRDS(seq.sid.irm.lk1.in.no2,file="./files/seq.tables/seq.sid.irm.lk1.in.no2.rds")
saveRDS(seq.sid.irm.lk1.off.no2,file="./files/seq.tables/seq.sid.irm.lk1.off.no2.rds")

saveRDS(seq.sid.pos.lk1.in.no2,file="./files/seq.tables/seq.sid.pos.lk1.in.no2.rds")
saveRDS(seq.sid.pos.lk1.off.no2,file="./files/seq.tables/seq.sid.pos.lk1.off.no2.rds")

#upper keys 1
saveRDS(seq.sid.pre.uk1.in.no2,file="./files/seq.tables/seq.sid.pre.uk1.in.no2.rds")
saveRDS(seq.sid.pre.uk1.off.no2,file="./files/seq.tables/seq.sid.pre.uk1.off.no2.rds")

saveRDS(seq.sid.irm.uk1.in.no2,file="./files/seq.tables/seq.sid.irm.uk1.in.no2.rds")
saveRDS(seq.sid.irm.uk1.off.no2,file="./files/seq.tables/seq.sid.irm.uk1.off.no2.rds")

saveRDS(seq.sid.pos.uk1.in.no2,file="./files/seq.tables/seq.sid.pos.uk1.in.no2.rds")
saveRDS(seq.sid.pos.uk1.off.no2,file="./files/seq.tables/seq.sid.pos.uk1.off.no2.rds")

#upper keys 2
saveRDS(seq.sid.pre.uk2.in.no2,file="./files/seq.tables/seq.sid.pre.uk2.in.no2.rds")
saveRDS(seq.sid.pre.uk2.off.no2,file="./files/seq.tables/seq.sid.pre.uk2.off.no2.rds")

saveRDS(seq.sid.irm.uk2.in.no2,file="./files/seq.tables/seq.sid.irm.uk2.in.no2.rds")
saveRDS(seq.sid.irm.uk2.off.no2,file="./files/seq.tables/seq.sid.irm.uk2.off.no2.rds")

saveRDS(seq.sid.pos.uk2.in.no2,file="./files/seq.tables/seq.sid.pos.uk2.in.no2.rds")
saveRDS(seq.sid.pos.uk2.off.no2,file="./files/seq.tables/seq.sid.pos.uk2.off.no2.rds")

#sparcc files
#lower keys 1
saveRDS(spar.sid.pre.lk1i,file="./files/sparcc/spar.sid.pre.lk1i.rds")
saveRDS(spar.sid.pre.lk1o,file="./files/sparcc/spar.sid.pre.lk1o.rds")

saveRDS(spar.sid.irm.lk1i,file="./files/sparcc/spar.sid.irm.lk1i.rds")
saveRDS(spar.sid.irm.lk1o,file="./files/sparcc/spar.sid.irm.lk1o.rds")

saveRDS(spar.sid.pos.lk1i,file="./files/sparcc/spar.sid.pos.lk1i.rds")
saveRDS(spar.sid.pos.lk1o,file="./files/sparcc/spar.sid.pos.lk1o.rds")

#upper keys 1
saveRDS(spar.sid.pre.uk1i,file="./files/sparcc/spar.sid.pre.uk1i.rds")
saveRDS(spar.sid.pre.uk1o,file="./files/sparcc/spar.sid.pre.uk1o.rds")

saveRDS(spar.sid.irm.uk1i,file="./files/sparcc/spar.sid.irm.uk1i.rds")
saveRDS(spar.sid.irm.uk1o,file="./files/sparcc/spar.sid.irm.uk1o.rds")

saveRDS(spar.sid.pos.uk1i,file="./files/sparcc/spar.sid.pos.uk1i.rds")
saveRDS(spar.sid.pos.uk1o,file="./files/sparcc/spar.sid.pos.uk1o.rds")

#upper keys 2
saveRDS(spar.sid.pre.uk2i,file="./files/sparcc/spar.sid.pre.uk2i.rds")
saveRDS(spar.sid.pre.uk2o,file="./files/sparcc/spar.sid.pre.uk2o.rds")

saveRDS(spar.sid.irm.uk2i,file="./files/sparcc/spar.sid.irm.uk2i.rds")
saveRDS(spar.sid.irm.uk2o,file="./files/sparcc/spar.sid.irm.uk2o.rds")

saveRDS(spar.sid.pos.uk2i,file="./files/sparcc/spar.sid.pos.uk2i.rds")
saveRDS(spar.sid.pos.uk2o,file="./files/sparcc/spar.sid.pos.uk2o.rds")

#adjacency files
#lower keys 1
saveRDS(adj.sid.pre.lk1i,file="./files/adjacency/adj.sid.pre.lk1i.rds")
saveRDS(adj.sid.pre.lk1o,file="./files/adjacency/adj.sid.pre.lk1o.rds")

saveRDS(adj.sid.irm.lk1i,file="./files/adjacency/adj.sid.irm.lk1i.rds")
saveRDS(adj.sid.irm.lk1o,file="./files/adjacency/adj.sid.irm.lk1o.rds")

saveRDS(adj.sid.pos.lk1i,file="./files/adjacency/adj.sid.pos.lk1i.rds")
saveRDS(adj.sid.pos.lk1o,file="./files/adjacency/adj.sid.pos.lk1o.rds")

#upper keys 1
saveRDS(adj.sid.pre.uk1i,file="./files/adjacency/adj.sid.pre.uk1i.rds")
saveRDS(adj.sid.pre.uk1o,file="./files/adjacency/adj.sid.pre.uk1o.rds")

saveRDS(adj.sid.irm.uk1i,file="./files/adjacency/adj.sid.irm.uk1i.rds")
saveRDS(adj.sid.irm.uk1o,file="./files/adjacency/adj.sid.irm.uk1o.rds")

saveRDS(adj.sid.pos.uk1i,file="./files/adjacency/adj.sid.pos.uk1i.rds")
saveRDS(adj.sid.pos.uk1o,file="./files/adjacency/adj.sid.pos.uk1o.rds")

#upper keys 2
saveRDS(adj.sid.pre.uk2i,file="./files/adjacency/adj.sid.pre.uk2i.rds")
saveRDS(adj.sid.pre.uk2o,file="./files/adjacency/adj.sid.pre.uk2o.rds")

saveRDS(adj.sid.irm.uk2i,file="./files/adjacency/adj.sid.irm.uk2i.rds")
saveRDS(adj.sid.irm.uk2o,file="./files/adjacency/adj.sid.irm.uk2o.rds")

saveRDS(adj.sid.pos.uk2i,file="./files/adjacency/adj.sid.pos.uk2i.rds")
saveRDS(adj.sid.pos.uk2o,file="./files/adjacency/adj.sid.pos.uk2o.rds")
```

### S. radians

Building an adjacency matrix of correlations of the abundances of bacterial ASVs

```{r build network}
# SparCC network
#lower keys 1
spar.rad.pre.lk1i <- sparcc(seq.rad.pre.lk1.in.no2)
spar.rad.pre.lk1o <- sparcc(seq.rad.pre.lk1.off.no2)

spar.rad.irm.lk1i <- sparcc(seq.rad.irm.lk1.in.no2)
spar.rad.irm.lk1o <- sparcc(seq.rad.irm.lk1.off.no2)

spar.rad.pos.lk1i <- sparcc(seq.rad.pos.lk1.in.no2)
spar.rad.pos.lk1o <- sparcc(seq.rad.pos.lk1.off.no2)

#upper keys 1
spar.rad.pre.uk1i <- sparcc(seq.rad.pre.uk1.in.no2)
spar.rad.pre.uk1o <- sparcc(seq.rad.pre.uk1.off.no2)

spar.rad.irm.uk1i <- sparcc(seq.rad.irm.uk1.in.no2)
spar.rad.irm.uk1o <- sparcc(seq.rad.irm.uk1.off.no2)

spar.rad.pos.uk1i <- sparcc(seq.rad.pos.uk1.in.no2)
spar.rad.pos.uk1o <- sparcc(seq.rad.pos.uk1.off.no2)

#upper keys 2
spar.rad.pre.uk2i <- sparcc(seq.rad.pre.uk2.in.no2)
spar.rad.pre.uk2o <- sparcc(seq.rad.pre.uk2.off.no2)

spar.rad.irm.uk2i <- sparcc(seq.rad.irm.uk2.in.no2)
spar.rad.irm.uk2o <- sparcc(seq.rad.irm.uk2.off.no2)

spar.rad.pos.uk2i <- sparcc(seq.rad.pos.uk2.in.no2)
spar.rad.pos.uk2o <- sparcc(seq.rad.pos.uk2.off.no2)

sparcc.cutoff <- 0.7

#lower keys 1
adj.rad.pre.lk1i <- ifelse(abs(spar.rad.pre.lk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.pre.lk1o <- ifelse(abs(spar.rad.pre.lk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.rad.irm.lk1i <- ifelse(abs(spar.rad.irm.lk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.irm.lk1o <- ifelse(abs(spar.rad.irm.lk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.rad.pos.lk1i <- ifelse(abs(spar.rad.pos.lk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.pos.lk1o <- ifelse(abs(spar.rad.pos.lk1o$Cor) >= sparcc.cutoff, 1, 0)

#upper keys 1
adj.rad.pre.uk1i <- ifelse(abs(spar.rad.pre.uk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.pre.uk1o <- ifelse(abs(spar.rad.pre.uk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.rad.irm.uk1i <- ifelse(abs(spar.rad.irm.uk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.irm.uk1o <- ifelse(abs(spar.rad.irm.uk1o$Cor) >= sparcc.cutoff, 1, 0)

adj.rad.pos.uk1i <- ifelse(abs(spar.rad.pos.uk1i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.pos.uk1o <- ifelse(abs(spar.rad.pos.uk1o$Cor) >= sparcc.cutoff, 1, 0)

#upper keys 2
adj.rad.pre.uk2i <- ifelse(abs(spar.rad.pre.uk2i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.pre.uk2o <- ifelse(abs(spar.rad.pre.uk2o$Cor) >= sparcc.cutoff, 1, 0)

adj.rad.irm.uk2i <- ifelse(abs(spar.rad.irm.uk2i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.irm.uk2o <- ifelse(abs(spar.rad.irm.uk2o$Cor) >= sparcc.cutoff, 1, 0)

adj.rad.pos.uk2i <- ifelse(abs(spar.rad.pos.uk2i$Cor) >= sparcc.cutoff, 1, 0)
adj.rad.pos.uk2o <- ifelse(abs(spar.rad.pos.uk2o$Cor) >= sparcc.cutoff, 1, 0)

# Add names to rows and columns
#lower keys 1 inshore
rownames(adj.rad.pre.lk1i) <- colnames(seq.rad.pre.lk1.in.no2)
colnames(adj.rad.pre.lk1i) <- colnames(seq.rad.pre.lk1.in.no2) 

rownames(adj.rad.irm.lk1i) <- colnames(seq.rad.irm.lk1.in.no2)
colnames(adj.rad.irm.lk1i) <- colnames(seq.rad.irm.lk1.in.no2) 

rownames(adj.rad.pos.lk1i) <- colnames(seq.rad.pos.lk1.in.no2)
colnames(adj.rad.pos.lk1i) <- colnames(seq.rad.pos.lk1.in.no2) 

#lower keys 1 offshore
rownames(adj.rad.pre.lk1o) <- colnames(seq.rad.pre.lk1.off.no2)
colnames(adj.rad.pre.lk1o) <- colnames(seq.rad.pre.lk1.off.no2) 

rownames(adj.rad.irm.lk1o) <- colnames(seq.rad.irm.lk1.off.no2)
colnames(adj.rad.irm.lk1o) <- colnames(seq.rad.irm.lk1.off.no2) 

rownames(adj.rad.pos.lk1o) <- colnames(seq.rad.pos.lk1.off.no2)
colnames(adj.rad.pos.lk1o) <- colnames(seq.rad.pos.lk1.off.no2) 

#upper keys 1 inshore
rownames(adj.rad.pre.uk1i) <- colnames(seq.rad.pre.uk1.in.no2)
colnames(adj.rad.pre.uk1i) <- colnames(seq.rad.pre.uk1.in.no2) 

rownames(adj.rad.irm.uk1i) <- colnames(seq.rad.irm.uk1.in.no2)
colnames(adj.rad.irm.uk1i) <- colnames(seq.rad.irm.uk1.in.no2) 

rownames(adj.rad.pos.uk1i) <- colnames(seq.rad.pos.uk1.in.no2)
colnames(adj.rad.pos.uk1i) <- colnames(seq.rad.pos.uk1.in.no2) 

#upper keys 1 offshore
rownames(adj.rad.pre.uk1o) <- colnames(seq.rad.pre.uk1.off.no2)
colnames(adj.rad.pre.uk1o) <- colnames(seq.rad.pre.uk1.off.no2) 

rownames(adj.rad.irm.uk1o) <- colnames(seq.rad.irm.uk1.off.no2)
colnames(adj.rad.irm.uk1o) <- colnames(seq.rad.irm.uk1.off.no2) 

rownames(adj.rad.pos.uk1o) <- colnames(seq.rad.pos.uk1.off.no2)
colnames(adj.rad.pos.uk1o) <- colnames(seq.rad.pos.uk1.off.no2) 

#upper keys 2 inshore
rownames(adj.rad.pre.uk2i) <- colnames(seq.rad.pre.uk2.in.no2)
colnames(adj.rad.pre.uk2i) <- colnames(seq.rad.pre.uk2.in.no2) 

rownames(adj.rad.irm.uk2i) <- colnames(seq.rad.irm.uk2.in.no2)
colnames(adj.rad.irm.uk2i) <- colnames(seq.rad.irm.uk2.in.no2) 

rownames(adj.rad.pos.uk2i) <- colnames(seq.rad.pos.uk2.in.no2)
colnames(adj.rad.pos.uk2i) <- colnames(seq.rad.pos.uk2.in.no2) 

#upper keys 2 offshore
rownames(adj.rad.pre.uk2o) <- colnames(seq.rad.pre.uk2.off.no2)
colnames(adj.rad.pre.uk2o) <- colnames(seq.rad.pre.uk2.off.no2) 

rownames(adj.rad.irm.uk2o) <- colnames(seq.rad.irm.uk2.off.no2)
colnames(adj.rad.irm.uk2o) <- colnames(seq.rad.irm.uk2.off.no2) 

rownames(adj.rad.pos.uk2o) <- colnames(seq.rad.pos.uk2.off.no2)
colnames(adj.rad.pos.uk2o) <- colnames(seq.rad.pos.uk2.off.no2) 
```

Saving everything

```{r, eval=F}
#sequence tables, cleaned
#lower keys 1
saveRDS(seq.rad.pre.lk1.in.no2,file="./files/seq.tables/seq.rad.pre.lk1.in.no2.rds")
saveRDS(seq.rad.pre.lk1.off.no2,file="./files/seq.tables/seq.rad.pre.lk1.off.no2.rds")

saveRDS(seq.rad.irm.lk1.in.no2,file="./files/seq.tables/seq.rad.irm.lk1.in.no2.rds")
saveRDS(seq.rad.irm.lk1.off.no2,file="./files/seq.tables/seq.rad.irm.lk1.off.no2.rds")

saveRDS(seq.rad.pos.lk1.in.no2,file="./files/seq.tables/seq.rad.pos.lk1.in.no2.rds")
saveRDS(seq.rad.pos.lk1.off.no2,file="./files/seq.tables/seq.rad.pos.lk1.off.no2.rds")

#upper keys 1
saveRDS(seq.rad.pre.uk1.in.no2,file="./files/seq.tables/seq.rad.pre.uk1.in.no2.rds")
saveRDS(seq.rad.pre.uk1.off.no2,file="./files/seq.tables/seq.rad.pre.uk1.off.no2.rds")

saveRDS(seq.rad.irm.uk1.in.no2,file="./files/seq.tables/seq.rad.irm.uk1.in.no2.rds")
saveRDS(seq.rad.irm.uk1.off.no2,file="./files/seq.tables/seq.rad.irm.uk1.off.no2.rds")

saveRDS(seq.rad.pos.uk1.in.no2,file="./files/seq.tables/seq.rad.pos.uk1.in.no2.rds")
saveRDS(seq.rad.pos.uk1.off.no2,file="./files/seq.tables/seq.rad.pos.uk1.off.no2.rds")

#upper keys 2
saveRDS(seq.rad.pre.uk2.in.no2,file="./files/seq.tables/seq.rad.pre.uk2.in.no2.rds")
saveRDS(seq.rad.pre.uk2.off.no2,file="./files/seq.tables/seq.rad.pre.uk2.off.no2.rds")

saveRDS(seq.rad.irm.uk2.in.no2,file="./files/seq.tables/seq.rad.irm.uk2.in.no2.rds")
saveRDS(seq.rad.irm.uk2.off.no2,file="./files/seq.tables/seq.rad.irm.uk2.off.no2.rds")

saveRDS(seq.rad.pos.uk2.in.no2,file="./files/seq.tables/seq.rad.pos.uk2.in.no2.rds")
saveRDS(seq.rad.pos.uk2.off.no2,file="./files/seq.tables/seq.rad.pos.uk2.off.no2.rds")

#sparcc files
#lower keys 1
saveRDS(spar.rad.pre.lk1i,file="./files/sparcc/spar.rad.pre.lk1i.rds")
saveRDS(spar.rad.pre.lk1o,file="./files/sparcc/spar.rad.pre.lk1o.rds")

saveRDS(spar.rad.irm.lk1i,file="./files/sparcc/spar.rad.irm.lk1i.rds")
saveRDS(spar.rad.irm.lk1o,file="./files/sparcc/spar.rad.irm.lk1o.rds")

saveRDS(spar.rad.pos.lk1i,file="./files/sparcc/spar.rad.pos.lk1i.rds")
saveRDS(spar.rad.pos.lk1o,file="./files/sparcc/spar.rad.pos.lk1o.rds")

#upper keys 1
saveRDS(spar.rad.pre.uk1i,file="./files/sparcc/spar.rad.pre.uk1i.rds")
saveRDS(spar.rad.pre.uk1o,file="./files/sparcc/spar.rad.pre.uk1o.rds")

saveRDS(spar.rad.irm.uk1i,file="./files/sparcc/spar.rad.irm.uk1i.rds")
saveRDS(spar.rad.irm.uk1o,file="./files/sparcc/spar.rad.irm.uk1o.rds")

saveRDS(spar.rad.pos.uk1i,file="./files/sparcc/spar.rad.pos.uk1i.rds")
saveRDS(spar.rad.pos.uk1o,file="./files/sparcc/spar.rad.pos.uk1o.rds")

#upper keys 2
saveRDS(spar.rad.pre.uk2i,file="./files/sparcc/spar.rad.pre.uk2i.rds")
saveRDS(spar.rad.pre.uk2o,file="./files/sparcc/spar.rad.pre.uk2o.rds")

saveRDS(spar.rad.irm.uk2i,file="./files/sparcc/spar.rad.irm.uk2i.rds")
saveRDS(spar.rad.irm.uk2o,file="./files/sparcc/spar.rad.irm.uk2o.rds")

saveRDS(spar.rad.pos.uk2i,file="./files/sparcc/spar.rad.pos.uk2i.rds")
saveRDS(spar.rad.pos.uk2o,file="./files/sparcc/spar.rad.pos.uk2o.rds")

#adjacency files
#lower keys 1
saveRDS(adj.rad.pre.lk1i,file="./files/adjacency/adj.rad.pre.lk1i.rds")
saveRDS(adj.rad.pre.lk1o,file="./files/adjacency/adj.rad.pre.lk1o.rds")

saveRDS(adj.rad.irm.lk1i,file="./files/adjacency/adj.rad.irm.lk1i.rds")
saveRDS(adj.rad.irm.lk1o,file="./files/adjacency/adj.rad.irm.lk1o.rds")

saveRDS(adj.rad.pos.lk1i,file="./files/adjacency/adj.rad.pos.lk1i.rds")
saveRDS(adj.rad.pos.lk1o,file="./files/adjacency/adj.rad.pos.lk1o.rds")

#upper keys 1
saveRDS(adj.rad.pre.uk1i,file="./files/adjacency/adj.rad.pre.uk1i.rds")
saveRDS(adj.rad.pre.uk1o,file="./files/adjacency/adj.rad.pre.uk1o.rds")

saveRDS(adj.rad.irm.uk1i,file="./files/adjacency/adj.rad.irm.uk1i.rds")
saveRDS(adj.rad.irm.uk1o,file="./files/adjacency/adj.rad.irm.uk1o.rds")

saveRDS(adj.rad.pos.uk1i,file="./files/adjacency/adj.rad.pos.uk1i.rds")
saveRDS(adj.rad.pos.uk1o,file="./files/adjacency/adj.rad.pos.uk1o.rds")

#upper keys 2
saveRDS(adj.rad.pre.uk2i,file="./files/adjacency/adj.rad.pre.uk2i.rds")
saveRDS(adj.rad.pre.uk2o,file="./files/adjacency/adj.rad.pre.uk2o.rds")

saveRDS(adj.rad.irm.uk2i,file="./files/adjacency/adj.rad.irm.uk2i.rds")
saveRDS(adj.rad.irm.uk2o,file="./files/adjacency/adj.rad.irm.uk2o.rds")

saveRDS(adj.rad.pos.uk2i,file="./files/adjacency/adj.rad.pos.uk2i.rds")
saveRDS(adj.rad.pos.uk2o,file="./files/adjacency/adj.rad.pos.uk2o.rds")
```

## *Re-read in everything*

```{r files wd}
##home
setwd("/Volumes/GoogleDrive/My Drive/Flirma/flirma_networks/fl_16s/04.networks/")
##work
#setwd("/Volumes/GoogleDrive-104519233854090018057/My Drive/Flirma/flirma_networks/fl_16s/04.networks")
```

### Adjacency - sids

```{r re-read in files}
#lk1 in
adj.sid.pre.lk1i <- readRDS("./files/adjacency/adj.sid.pre.lk1i.rds")
adj.sid.irm.lk1i <- readRDS("./files/adjacency/adj.sid.irm.lk1i.rds")
adj.sid.pos.lk1i <- readRDS("./files/adjacency/adj.sid.pos.lk1i.rds")

#lk1 off
adj.sid.pre.lk1o <- readRDS("./files/adjacency/adj.sid.pre.lk1o.rds")
adj.sid.irm.lk1o <- readRDS("./files/adjacency/adj.sid.irm.lk1o.rds")
adj.sid.pos.lk1o <- readRDS("./files/adjacency/adj.sid.pos.lk1o.rds")

#uk1 in
adj.sid.pre.uk1i <- readRDS("./files/adjacency/adj.sid.pre.uk1i.rds")
adj.sid.irm.uk1i <- readRDS("./files/adjacency/adj.sid.irm.uk1i.rds")
adj.sid.pos.uk1i <- readRDS("./files/adjacency/adj.sid.pos.uk1i.rds")

#uk1 off
adj.sid.pre.uk1o <- readRDS("./files/adjacency/adj.sid.pre.uk1o.rds")
adj.sid.irm.uk1o <- readRDS("./files/adjacency/adj.sid.irm.uk1o.rds")
adj.sid.pos.uk1o <- readRDS("./files/adjacency/adj.sid.pos.uk1o.rds")

#uk2 in
adj.sid.pre.uk2i <- readRDS("./files/adjacency/adj.sid.pre.uk2i.rds")
adj.sid.irm.uk2i <- readRDS("./files/adjacency/adj.sid.irm.uk2i.rds")
adj.sid.pos.uk2i <- readRDS("./files/adjacency/adj.sid.pos.uk2i.rds")

#uk2 off
adj.sid.pre.uk2o <- readRDS("./files/adjacency/adj.sid.pre.uk2o.rds")
adj.sid.irm.uk2o <- readRDS("./files/adjacency/adj.sid.irm.uk2o.rds")
adj.sid.pos.uk2o <- readRDS("./files/adjacency/adj.sid.pos.uk2o.rds")
```

### Adjacency - rads

```{r re-read in files}
#lk1 in
adj.rad.pre.lk1i <- readRDS("./files/adjacency/adj.rad.pre.lk1i.rds")
adj.rad.irm.lk1i <- readRDS("./files/adjacency/adj.rad.irm.lk1i.rds")
adj.rad.pos.lk1i <- readRDS("./files/adjacency/adj.rad.pos.lk1i.rds")

#lk1 off
adj.rad.pre.lk1o <- readRDS("./files/adjacency/adj.rad.pre.lk1o.rds")
adj.rad.irm.lk1o <- readRDS("./files/adjacency/adj.rad.irm.lk1o.rds")
adj.rad.pos.lk1o <- readRDS("./files/adjacency/adj.rad.pos.lk1o.rds")

#uk1 in
adj.rad.pre.uk1i <- readRDS("./files/adjacency/adj.rad.pre.uk1i.rds")
adj.rad.irm.uk1i <- readRDS("./files/adjacency/adj.rad.irm.uk1i.rds")
#adj.rad.pos.uk1i <- readRDS("./files/adjacency/adj.rad.pos.uk1i.rds") #NA

#uk1 off
adj.rad.pre.uk1o <- readRDS("./files/adjacency/adj.rad.pre.uk1o.rds")
#adj.rad.irm.uk1o <- readRDS("./files/adjacency/adj.rad.irm.uk1o.rds") #NA
#adj.rad.pos.uk1o <- readRDS("./files/adjacency/adj.rad.pos.uk1o.rds") #NA

#uk2 in
adj.rad.pre.uk2i <- readRDS("./files/adjacency/adj.rad.pre.uk2i.rds")
adj.rad.irm.uk2i <- readRDS("./files/adjacency/adj.rad.irm.uk2i.rds")
adj.rad.pos.uk2i <- readRDS("./files/adjacency/adj.rad.pos.uk2i.rds")

#uk2 off
adj.rad.pre.uk2o <- readRDS("./files/adjacency/adj.rad.pre.uk2o.rds")
adj.rad.irm.uk2o <- readRDS("./files/adjacency/adj.rad.irm.uk2o.rds")
adj.rad.pos.uk2o <- readRDS("./files/adjacency/adj.rad.pos.uk2o.rds")
```

## Visualizing network from adjacency matrix

### ASV plots - sids{.tabset}

#### LK1 - sids

```{r plot net from adj matrix}
#removed size.min=1 from options
net.sid.pre.lk1i <- ggnet2(adj.sid.pre.lk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore pre-disturb.')
#net.sid.pre.lk1i
net.sid.pre.lk1o <- ggnet2(adj.sid.pre.lk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore pre-disturb.')
#net.sid.pre.lk1o

#ggarrange(net.sid.pre.lk1i,net.sid.pre.lk1o)

net.sid.irm.lk1i <- ggnet2(adj.sid.irm.lk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore disturbance')
#net.sid.irm.lk1i
net.sid.irm.lk1o <- ggnet2(adj.sid.irm.lk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore disturbance')
#net.sid.irm.lk1o

#ggarrange(net.sid.irm.lk1i,net.sid.irm.lk1o)            

net.sid.pos.lk1i <- ggnet2(adj.sid.pos.lk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore post-disturb.')
#net.sid.pos.lk1i
net.sid.pos.lk1o <- ggnet2(adj.sid.pos.lk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore post-disturb.')
#net.sid.pos.lk1o

#ggarrange(net.sid.pos.lk1i,net.sid.pos.lk1o)   
```

All together now

```{r}
gg.net.lk1 <- ggarrange(net.sid.pre.lk1i,net.sid.pre.lk1o,net.sid.irm.lk1i,net.sid.irm.lk1o,net.sid.pos.lk1i,net.sid.pos.lk1o,ncol=2,nrow=3)

gg.net.lk1

annotate_figure(gg.net.lk1,top=text_grob("S. siderea - Lower Keys 1",size=16))

#ggsave("gg.net.sid.lk1.pdf",width=4.5,height=7.5)
```

#### UK1 - sids

```{r plot net from adj matrix}
net.sid.pre.uk1i <- ggnet2(adj.sid.pre.uk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore pre-disturb.')
#net.sid.pre.uk1i
net.sid.pre.uk1o <- ggnet2(adj.sid.pre.uk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore pre-disturb.')
#net.sid.pre.uk1o

#ggarrange(net.sid.pre.uk1i,net.sid.pre.uk1o)

net.sid.irm.uk1i <- ggnet2(adj.sid.irm.uk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore disturbance')
#net.sid.irm.uk1i
net.sid.irm.uk1o <- ggnet2(adj.sid.irm.uk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore disturbance')
#net.sid.irm.uk1o

#ggarrange(net.sid.irm.uk1i,net.sid.irm.uk1o)            

net.sid.pos.uk1i <- ggnet2(adj.sid.pos.uk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore post-disturb.')
#net.sid.pos.uk1i
net.sid.pos.uk1o <- ggnet2(adj.sid.pos.uk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore post-disturb.')
#net.sid.pos.uk1o

#ggarrange(net.sid.pos.uk1i,net.sid.pos.uk1o)   
```

All together now

```{r}
gg.net.uk1 <- ggarrange(net.sid.pre.uk1i,net.sid.pre.uk1o,net.sid.irm.uk1i,net.sid.irm.uk1o,net.sid.pos.uk1i,net.sid.pos.uk1o,ncol=2,nrow=3)
gg.net.uk1

annotate_figure(gg.net.uk1,top=text_grob("S. siderea - Upper Keys 1",size=16))

ggsave("gg.net.uk1.pdf",width=4.5,height=7.5)
```

#### UK2 - sids

```{r plot net from adj matrix}
net.sid.pre.uk2i <- ggnet2(adj.sid.pre.uk2i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore pre-disturb.')
#net.sid.pre.uk2i
net.sid.pre.uk2o <- ggnet2(adj.sid.pre.uk2o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore pre-disturb.')
#net.sid.pre.uk2o

#ggarrange(net.sid.pre.uk2i,net.sid.pre.uk2o)

net.sid.irm.uk2i <- ggnet2(adj.sid.irm.uk2i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore disturbance')
#net.sid.irm.uk2i
net.sid.irm.uk2o <- ggnet2(adj.sid.irm.uk2o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore disturbance')
#net.sid.irm.uk2o

#ggarrange(net.sid.irm.uk2i,net.sid.irm.uk2o)            

net.sid.pos.uk2i <- ggnet2(adj.sid.pos.uk2i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore post-disturb.')
#net.sid.pos.uk2i
net.sid.pos.uk2o <- ggnet2(adj.sid.pos.uk2o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore post-disturb.')
#net.sid.pos.uk2o

#ggarrange(net.sid.pos.uk2i,net.sid.pos.uk2o)   
```

All together now

```{r}
gg.net.uk2 <- ggarrange(net.sid.pre.uk2i,net.sid.pre.uk2o,net.sid.irm.uk2i,net.sid.irm.uk2o,net.sid.pos.uk2i,net.sid.pos.uk2o,ncol=2,nrow=3)

annotate_figure(gg.net.uk2,top=text_grob("S. siderea - Upper Keys 2",size=16))

#ggsave("gg.net.uk2.pdf",width=4.5,height=7.5)
```

### ASV plots - rads{.tabset}

#### LK1 - rads

```{r plot net from adj matrix}
net.rad.pre.lk1i <- ggnet2(adj.rad.pre.lk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore pre-disturb.')
#net.rad.pre.lk1i
net.rad.pre.lk1o <- ggnet2(adj.rad.pre.lk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore pre-disturb.')
#net.rad.pre.lk1o

#ggarrange(net.rad.pre.lk1i,net.rad.pre.lk1o)

net.rad.irm.lk1i <- ggnet2(adj.rad.irm.lk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore disturbance')
#net.rad.irm.lk1i
net.rad.irm.lk1o <- ggnet2(adj.rad.irm.lk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore disturbance')
#net.rad.irm.lk1o

#ggarrange(net.rad.irm.lk1i,net.rad.irm.lk1o)            

net.rad.pos.lk1i <- ggnet2(adj.rad.pos.lk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore post-disturb.')
#net.rad.pos.lk1i
net.rad.pos.lk1o <- ggnet2(adj.rad.pos.lk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore post-disturb.')
#net.rad.pos.lk1o

#ggarrange(net.rad.pos.lk1i,net.rad.pos.lk1o)   
```

All together now

```{r}
gg.net.rad.lk1 <- ggarrange(net.rad.pre.lk1i,net.rad.pre.lk1o,net.rad.irm.lk1i,net.rad.irm.lk1o,net.rad.pos.lk1i,net.rad.pos.lk1o,ncol=2,nrow=3)

annotate_figure(gg.net.rad.lk1,top=text_grob("S. radians - Lower Keys 1",size=16))

#ggsave("gg.net.rad.lk1.pdf",width=4.5,height=7.5)
```

#### UK1 - rads

```{r plot net from adj matrix}
net.rad.pre.uk1i <- ggnet2(adj.rad.pre.uk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore pre-disturb.')
#net.rad.pre.uk1i
net.rad.pre.uk1o <- ggnet2(adj.rad.pre.uk1o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore pre-disturb.')
#net.rad.pre.uk1o

#ggarrange(net.rad.pre.uk1i,net.rad.pre.uk1o)

net.rad.irm.uk1i <- ggnet2(adj.rad.irm.uk1i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore disturbance')
#net.rad.irm.uk1i
#net.rad.irm.uk1o <- ggnet2(adj.rad.irm.uk1o,size=1,alpha=0.5,color="#14505C")+
#  ggtitle('Offshore disturbance')
#net.rad.irm.uk1o

#ggarrange(net.rad.irm.uk1i,net.rad.irm.uk1o)            

#net.rad.pos.uk1i <- ggnet2(adj.rad.pos.uk1i,size=1,alpha=0.5,color="#6BBE99")+
#  ggtitle('Inshore post-disturb.')
#net.rad.pos.uk1i
#net.rad.pos.uk1o <- ggnet2(adj.rad.pos.uk1o,size=1,alpha=0.5,color="#14505C")+
#  ggtitle('Offshore post-disturb.')
#net.rad.pos.uk1o

#ggarrange(net.rad.pos.uk1i,net.rad.pos.uk1o)   
```

All together now

```{r}
gg.net.uk1 <- ggarrange(net.rad.pre.uk1i,net.rad.pre.uk1o,net.rad.irm.uk1i,ncol=2,nrow=3)

annotate_figure(gg.net.uk1,top=text_grob("S. radians - Upper Keys 1",size=16))

#ggsave("gg.net.rad.uk1.pdf",width=4.5,height=7.5)
```

#### UK2 - rads

```{r plot net from adj matrix}
net.rad.pre.uk2i <- ggnet2(adj.rad.pre.uk2i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore pre-disturb.')
#net.rad.pre.uk2i
net.rad.pre.uk2o <- ggnet2(adj.rad.pre.uk2o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore pre-disturb.')
#net.rad.pre.uk2o

#ggarrange(net.rad.pre.uk2i,net.rad.pre.uk2o)

net.rad.irm.uk2i <- ggnet2(adj.rad.irm.uk2i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore disturbance')
#net.rad.irm.uk2i
net.rad.irm.uk2o <- ggnet2(adj.rad.irm.uk2o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore disturbance')
#net.rad.irm.uk2o

#ggarrange(net.rad.irm.uk2i,net.rad.irm.uk2o)            

net.rad.pos.uk2i <- ggnet2(adj.rad.pos.uk2i,size=1,alpha=0.5,color="#6BBE99")+
  ggtitle('Inshore post-disturb.')
#net.rad.pos.uk2i
net.rad.pos.uk2o <- ggnet2(adj.rad.pos.uk2o,size=1,alpha=0.5,color="#14505C")+
  ggtitle('Offshore post-disturb.')
#net.rad.pos.uk2o

#ggarrange(net.rad.pos.uk2i,net.rad.pos.uk2o)  
```

All together now

```{r}
gg.net.uk2 <- ggarrange(net.rad.pre.uk2i,net.rad.pre.uk2o,net.rad.irm.uk2i,net.rad.irm.uk2o,net.rad.pos.uk2i,net.rad.pos.uk2o,ncol=2,nrow=3)

annotate_figure(gg.net.uk2,top=text_grob("S. radians - Upper Keys 2",size=16))

#ggsave("gg.net.rad.uk2.pdf",width=4.5,height=7.5)
```

# Metrics

```{r}
library(igraph)
```

## Build networks - sids

```{r}
# Build network from adjacency
#lower keys 1
net.sid.pre.lk1i <- graph.adjacency(adj.sid.pre.lk1i, mode = "undirected", diag = FALSE)
net.sid.pre.lk1o <- graph.adjacency(adj.sid.pre.lk1o, mode = "undirected", diag = FALSE)

net.sid.irm.lk1i <- graph.adjacency(adj.sid.irm.lk1i, mode = "undirected", diag = FALSE)
net.sid.irm.lk1o <- graph.adjacency(adj.sid.irm.lk1o, mode = "undirected", diag = FALSE)

net.sid.pos.lk1i <- graph.adjacency(adj.sid.pos.lk1i, mode = "undirected", diag = FALSE)
net.sid.pos.lk1o <- graph.adjacency(adj.sid.pos.lk1o, mode = "undirected", diag = FALSE)

#upper keys 1
net.sid.pre.uk1i <- graph.adjacency(adj.sid.pre.uk1i, mode = "undirected", diag = FALSE)
net.sid.pre.uk1o <- graph.adjacency(adj.sid.pre.uk1o, mode = "undirected", diag = FALSE)

net.sid.irm.uk1i <- graph.adjacency(adj.sid.irm.uk1i, mode = "undirected", diag = FALSE)
net.sid.irm.uk1o <- graph.adjacency(adj.sid.irm.uk1o, mode = "undirected", diag = FALSE)

net.sid.pos.uk1i <- graph.adjacency(adj.sid.pos.uk1i, mode = "undirected", diag = FALSE)
net.sid.pos.uk1o <- graph.adjacency(adj.sid.pos.uk1o, mode = "undirected", diag = FALSE)

#upper keys 2
net.sid.pre.uk2i <- graph.adjacency(adj.sid.pre.uk2i, mode = "undirected", diag = FALSE)
net.sid.pre.uk2o <- graph.adjacency(adj.sid.pre.uk2o, mode = "undirected", diag = FALSE)

net.sid.irm.uk2i <- graph.adjacency(adj.sid.irm.uk2i, mode = "undirected", diag = FALSE)
net.sid.irm.uk2o <- graph.adjacency(adj.sid.irm.uk2o, mode = "undirected", diag = FALSE)

net.sid.pos.uk2i <- graph.adjacency(adj.sid.pos.uk2i, mode = "undirected", diag = FALSE)
net.sid.pos.uk2o <- graph.adjacency(adj.sid.pos.uk2o, mode = "undirected", diag = FALSE)
```

## Build networks - rads

```{r}
# Build network from adjacency
#lower keys 1
net.rad.pre.lk1i <- graph.adjacency(adj.rad.pre.lk1i, mode = "undirected", diag = FALSE)
net.rad.pre.lk1o <- graph.adjacency(adj.rad.pre.lk1o, mode = "undirected", diag = FALSE)

net.rad.irm.lk1i <- graph.adjacency(adj.rad.irm.lk1i, mode = "undirected", diag = FALSE)
net.rad.irm.lk1o <- graph.adjacency(adj.rad.irm.lk1o, mode = "undirected", diag = FALSE)

net.rad.pos.lk1i <- graph.adjacency(adj.rad.pos.lk1i, mode = "undirected", diag = FALSE)
net.rad.pos.lk1o <- graph.adjacency(adj.rad.pos.lk1o, mode = "undirected", diag = FALSE)

#upper keys 1
net.rad.pre.uk1i <- graph.adjacency(adj.rad.pre.uk1i, mode = "undirected", diag = FALSE)
net.rad.pre.uk1o <- graph.adjacency(adj.rad.pre.uk1o, mode = "undirected", diag = FALSE)

net.rad.irm.uk1i <- graph.adjacency(adj.rad.irm.uk1i, mode = "undirected", diag = FALSE)
#net.rad.irm.uk1o <- graph.adjacency(adj.rad.irm.uk1o, mode = "undirected", diag = FALSE)

#net.rad.pos.uk1i <- graph.adjacency(adj.rad.pos.uk1i, mode = "undirected", diag = FALSE)
#net.rad.pos.uk1o <- graph.adjacency(adj.rad.pos.uk1o, mode = "undirected", diag = FALSE)

#upper keys 2
net.rad.pre.uk2i <- graph.adjacency(adj.rad.pre.uk2i, mode = "undirected", diag = FALSE)
net.rad.pre.uk2o <- graph.adjacency(adj.rad.pre.uk2o, mode = "undirected", diag = FALSE)

net.rad.irm.uk2i <- graph.adjacency(adj.rad.irm.uk2i, mode = "undirected", diag = FALSE)
net.rad.irm.uk2o <- graph.adjacency(adj.rad.irm.uk2o, mode = "undirected", diag = FALSE)

net.rad.pos.uk2i <- graph.adjacency(adj.rad.pos.uk2i, mode = "undirected", diag = FALSE)
net.rad.pos.uk2o <- graph.adjacency(adj.rad.pos.uk2o, mode = "undirected", diag = FALSE)
```

## Eigen centrality{.tabset}

### Sids - lk1

```{r}
##LK1 inshore pre
cen.sid.pre.lk1i <- eigen_centrality(net.sid.pre.lk1i)$vector
cen.cen.sid.pre.lk1i.sorted <- sort(cen.sid.pre.lk1i,decreasing=TRUE)
cen.sid.pre.lk1i.top10 <- cen.cen.sid.pre.lk1i.sorted[1:10]

cen.sid.pre.lk1i.top10.df <- data.frame(cen.sid.pre.lk1i.top10)
cen.sid.pre.lk1i.top10.df$sqs <- row.names(cen.sid.pre.lk1i.top10.df)

cen.sid.pre.lk1i.top10.df$site <- rep("LK1",nrow(cen.sid.pre.lk1i.top10.df))
cen.sid.pre.lk1i.top10.df$zone <- rep("Inshore",nrow(cen.sid.pre.lk1i.top10.df))
cen.sid.pre.lk1i.top10.df$time <- rep("Pre",nrow(cen.sid.pre.lk1i.top10.df))

names(cen.sid.pre.lk1i.top10.df)[names(cen.sid.pre.lk1i.top10.df) == 'cen.sid.pre.lk1i.top10'] <- 'cent'

##LK1 offshore pre
cen.sid.pre.lk1o <- eigen_centrality(net.sid.pre.lk1o)$vector
cen.cen.sid.pre.lk1o.sorted <- sort(cen.sid.pre.lk1o,decreasing=TRUE)
cen.sid.pre.lk1o.top10 <- cen.cen.sid.pre.lk1o.sorted[1:10]

cen.sid.pre.lk1o.top10.df <- data.frame(cen.sid.pre.lk1o.top10)
cen.sid.pre.lk1o.top10.df$sqs <- row.names(cen.sid.pre.lk1o.top10.df)

cen.sid.pre.lk1o.top10.df$site <- rep("LK1",nrow(cen.sid.pre.lk1o.top10.df))
cen.sid.pre.lk1o.top10.df$zone <- rep("Offshore",nrow(cen.sid.pre.lk1o.top10.df))
cen.sid.pre.lk1o.top10.df$time <- rep("Pre",nrow(cen.sid.pre.lk1o.top10.df))

names(cen.sid.pre.lk1o.top10.df)[names(cen.sid.pre.lk1o.top10.df) == 'cen.sid.pre.lk1o.top10'] <- 'cent'

##LK1 inshore irm
cen.sid.irm.lk1i <- eigen_centrality(net.sid.irm.lk1i)$vector
cen.cen.sid.irm.lk1i.sorted <- sort(cen.sid.irm.lk1i,decreasing=TRUE)
cen.sid.irm.lk1i.top10 <- cen.cen.sid.irm.lk1i.sorted[1:10]

cen.sid.irm.lk1i.top10.df <- data.frame(cen.sid.irm.lk1i.top10)
cen.sid.irm.lk1i.top10.df$sqs <- row.names(cen.sid.irm.lk1i.top10.df)

cen.sid.irm.lk1i.top10.df$site <- rep("LK1",nrow(cen.sid.irm.lk1i.top10.df))
cen.sid.irm.lk1i.top10.df$zone <- rep("Inshore",nrow(cen.sid.irm.lk1i.top10.df))
cen.sid.irm.lk1i.top10.df$time <- rep("Irma",nrow(cen.sid.irm.lk1i.top10.df))

names(cen.sid.irm.lk1i.top10.df)[names(cen.sid.irm.lk1i.top10.df) == 'cen.sid.irm.lk1i.top10'] <- 'cent'

##LK1 offshore irm
cen.sid.irm.lk1o <- eigen_centrality(net.sid.irm.lk1o)$vector
cen.cen.sid.irm.lk1o.sorted <- sort(cen.sid.irm.lk1o,decreasing=TRUE)
cen.sid.irm.lk1o.top10 <- cen.cen.sid.irm.lk1o.sorted[1:10]

cen.sid.irm.lk1o.top10.df <- data.frame(cen.sid.irm.lk1o.top10)
cen.sid.irm.lk1o.top10.df$sqs <- row.names(cen.sid.irm.lk1o.top10.df)

cen.sid.irm.lk1o.top10.df$site <- rep("LK1",nrow(cen.sid.irm.lk1o.top10.df))
cen.sid.irm.lk1o.top10.df$zone <- rep("Offshore",nrow(cen.sid.irm.lk1o.top10.df))
cen.sid.irm.lk1o.top10.df$time <- rep("Irma",nrow(cen.sid.irm.lk1o.top10.df))

names(cen.sid.irm.lk1o.top10.df)[names(cen.sid.irm.lk1o.top10.df) == 'cen.sid.irm.lk1o.top10'] <- 'cent'

#ggplot(data=cen.sid.pre.lk1o.top10.df,aes(x=sqs,y=cen.sid.pre.lk1o.top10))+
#  geom_bar(stat="identity")

##LK1 inshore post
cen.sid.pos.lk1i <- eigen_centrality(net.sid.pos.lk1i)$vector
cen.cen.sid.pos.lk1i.sorted <- sort(cen.sid.pos.lk1i,decreasing=TRUE)
cen.sid.pos.lk1i.top10 <- cen.cen.sid.pos.lk1i.sorted[1:10]

cen.sid.pos.lk1i.top10.df <- data.frame(cen.sid.pos.lk1i.top10)
cen.sid.pos.lk1i.top10.df$sqs <- row.names(cen.sid.pos.lk1i.top10.df)

cen.sid.pos.lk1i.top10.df$site <- rep("LK1",nrow(cen.sid.pos.lk1i.top10.df))
cen.sid.pos.lk1i.top10.df$zone <- rep("Inshore",nrow(cen.sid.pos.lk1i.top10.df))
cen.sid.pos.lk1i.top10.df$time <- rep("Post",nrow(cen.sid.pos.lk1i.top10.df))

names(cen.sid.pos.lk1i.top10.df)[names(cen.sid.pos.lk1i.top10.df) == 'cen.sid.pos.lk1i.top10'] <- 'cent'

##LK1 offshore post
cen.sid.pos.lk1o <- eigen_centrality(net.sid.pos.lk1o)$vector
cen.cen.sid.pos.lk1o.sorted <- sort(cen.sid.pos.lk1o,decreasing=TRUE)
cen.sid.pos.lk1o.top10 <- cen.cen.sid.pos.lk1o.sorted[1:10]

cen.sid.pos.lk1o.top10.df <- data.frame(cen.sid.pos.lk1o.top10)
cen.sid.pos.lk1o.top10.df$sqs <- row.names(cen.sid.pos.lk1o.top10.df)

cen.sid.pos.lk1o.top10.df$site <- rep("LK1",nrow(cen.sid.pos.lk1o.top10.df))
cen.sid.pos.lk1o.top10.df$zone <- rep("Offshore",nrow(cen.sid.pos.lk1o.top10.df))
cen.sid.pos.lk1o.top10.df$time <- rep("Post",nrow(cen.sid.pos.lk1o.top10.df))

#ggplot(data=cen.sid.pre.lk1o.top10.df,aes(x=sqs,y=cen.sid.pre.lk1o.top10))+
#  geom_bar(stat="identity")

names(cen.sid.pos.lk1o.top10.df)[names(cen.sid.pos.lk1o.top10.df) == 'cen.sid.pos.lk1o.top10'] <- 'cent'

cen.sid.lk1 <- rbind(cen.sid.pre.lk1i.top10.df,cen.sid.pre.lk1o.top10.df,cen.sid.irm.lk1i.top10.df,cen.sid.irm.lk1o.top10.df,cen.sid.pos.lk1i.top10.df,cen.sid.pos.lk1o.top10.df)
```

### Sids - UK1

```{r}
##uk1 inshore pre
cen.sid.pre.uk1i <- eigen_centrality(net.sid.pre.uk1i)$vector
cen.cen.sid.pre.uk1i.sorted <- sort(cen.sid.pre.uk1i,decreasing=TRUE)
cen.sid.pre.uk1i.top10 <- cen.cen.sid.pre.uk1i.sorted[1:10]

cen.sid.pre.uk1i.top10.df <- data.frame(cen.sid.pre.uk1i.top10)
cen.sid.pre.uk1i.top10.df$sqs <- row.names(cen.sid.pre.uk1i.top10.df)

cen.sid.pre.uk1i.top10.df$site <- rep("UK1",nrow(cen.sid.pre.uk1i.top10.df))
cen.sid.pre.uk1i.top10.df$zone <- rep("Inshore",nrow(cen.sid.pre.uk1i.top10.df))
cen.sid.pre.uk1i.top10.df$time <- rep("Pre",nrow(cen.sid.pre.uk1i.top10.df))

names(cen.sid.pre.uk1i.top10.df)[names(cen.sid.pre.uk1i.top10.df) == 'cen.sid.pre.uk1i.top10'] <- 'cent'

##uk1 offshore pre
cen.sid.pre.uk1o <- eigen_centrality(net.sid.pre.uk1o)$vector
cen.cen.sid.pre.uk1o.sorted <- sort(cen.sid.pre.uk1o,decreasing=TRUE)
cen.sid.pre.uk1o.top10 <- cen.cen.sid.pre.uk1o.sorted[1:10]

cen.sid.pre.uk1o.top10.df <- data.frame(cen.sid.pre.uk1o.top10)
cen.sid.pre.uk1o.top10.df$sqs <- row.names(cen.sid.pre.uk1o.top10.df)

cen.sid.pre.uk1o.top10.df$site <- rep("UK1",nrow(cen.sid.pre.uk1o.top10.df))
cen.sid.pre.uk1o.top10.df$zone <- rep("Offshore",nrow(cen.sid.pre.uk1o.top10.df))
cen.sid.pre.uk1o.top10.df$time <- rep("Pre",nrow(cen.sid.pre.uk1o.top10.df))

names(cen.sid.pre.uk1o.top10.df)[names(cen.sid.pre.uk1o.top10.df) == 'cen.sid.pre.uk1o.top10'] <- 'cent'

##uk1 inshore irm
cen.sid.irm.uk1i <- eigen_centrality(net.sid.irm.uk1i)$vector
cen.cen.sid.irm.uk1i.sorted <- sort(cen.sid.irm.uk1i,decreasing=TRUE)
cen.sid.irm.uk1i.top10 <- cen.cen.sid.irm.uk1i.sorted[1:10]

cen.sid.irm.uk1i.top10.df <- data.frame(cen.sid.irm.uk1i.top10)
cen.sid.irm.uk1i.top10.df$sqs <- row.names(cen.sid.irm.uk1i.top10.df)

cen.sid.irm.uk1i.top10.df$site <- rep("UK1",nrow(cen.sid.irm.uk1i.top10.df))
cen.sid.irm.uk1i.top10.df$zone <- rep("Inshore",nrow(cen.sid.irm.uk1i.top10.df))
cen.sid.irm.uk1i.top10.df$time <- rep("Irma",nrow(cen.sid.irm.uk1i.top10.df))

names(cen.sid.irm.uk1i.top10.df)[names(cen.sid.irm.uk1i.top10.df) == 'cen.sid.irm.uk1i.top10'] <- 'cent'

##uk1 offshore irm
cen.sid.irm.uk1o <- eigen_centrality(net.sid.irm.uk1o)$vector
cen.cen.sid.irm.uk1o.sorted <- sort(cen.sid.irm.uk1o,decreasing=TRUE)
cen.sid.irm.uk1o.top10 <- cen.cen.sid.irm.uk1o.sorted[1:10]

cen.sid.irm.uk1o.top10.df <- data.frame(cen.sid.irm.uk1o.top10)
cen.sid.irm.uk1o.top10.df$sqs <- row.names(cen.sid.irm.uk1o.top10.df)

cen.sid.irm.uk1o.top10.df$site <- rep("UK1",nrow(cen.sid.irm.uk1o.top10.df))
cen.sid.irm.uk1o.top10.df$zone <- rep("Offshore",nrow(cen.sid.irm.uk1o.top10.df))
cen.sid.irm.uk1o.top10.df$time <- rep("Irma",nrow(cen.sid.irm.uk1o.top10.df))

names(cen.sid.irm.uk1o.top10.df)[names(cen.sid.irm.uk1o.top10.df) == 'cen.sid.irm.uk1o.top10'] <- 'cent'

#ggplot(data=cen.sid.pre.uk1o.top10.df,aes(x=sqs,y=cen.sid.pre.uk1o.top10))+
#  geom_bar(stat="identity")

##uk1 inshore post
cen.sid.pos.uk1i <- eigen_centrality(net.sid.pos.uk1i)$vector
cen.cen.sid.pos.uk1i.sorted <- sort(cen.sid.pos.uk1i,decreasing=TRUE)
cen.sid.pos.uk1i.top10 <- cen.cen.sid.pos.uk1i.sorted[1:10]

cen.sid.pos.uk1i.top10.df <- data.frame(cen.sid.pos.uk1i.top10)
cen.sid.pos.uk1i.top10.df$sqs <- row.names(cen.sid.pos.uk1i.top10.df)

cen.sid.pos.uk1i.top10.df$site <- rep("UK1",nrow(cen.sid.pos.uk1i.top10.df))
cen.sid.pos.uk1i.top10.df$zone <- rep("Inshore",nrow(cen.sid.pos.uk1i.top10.df))
cen.sid.pos.uk1i.top10.df$time <- rep("Post",nrow(cen.sid.pos.uk1i.top10.df))

names(cen.sid.pos.uk1i.top10.df)[names(cen.sid.pos.uk1i.top10.df) == 'cen.sid.pos.uk1i.top10'] <- 'cent'

##uk1 offshore post
cen.sid.pos.uk1o <- eigen_centrality(net.sid.pos.uk1o)$vector
cen.cen.sid.pos.uk1o.sorted <- sort(cen.sid.pos.uk1o,decreasing=TRUE)
cen.sid.pos.uk1o.top10 <- cen.cen.sid.pos.uk1o.sorted[1:10]

cen.sid.pos.uk1o.top10.df <- data.frame(cen.sid.pos.uk1o.top10)
cen.sid.pos.uk1o.top10.df$sqs <- row.names(cen.sid.pos.uk1o.top10.df)

cen.sid.pos.uk1o.top10.df$site <- rep("UK1",nrow(cen.sid.pos.uk1o.top10.df))
cen.sid.pos.uk1o.top10.df$zone <- rep("Offshore",nrow(cen.sid.pos.uk1o.top10.df))
cen.sid.pos.uk1o.top10.df$time <- rep("Post",nrow(cen.sid.pos.uk1o.top10.df))

#ggplot(data=cen.sid.pre.uk1o.top10.df,aes(x=sqs,y=cen.sid.pre.uk1o.top10))+
#  geom_bar(stat="identity")

names(cen.sid.pos.uk1o.top10.df)[names(cen.sid.pos.uk1o.top10.df) == 'cen.sid.pos.uk1o.top10'] <- 'cent'

cen.sid.uk1 <- rbind(cen.sid.pre.uk1i.top10.df,cen.sid.pre.uk1o.top10.df,cen.sid.irm.uk1i.top10.df,cen.sid.irm.uk1o.top10.df,cen.sid.pos.uk1i.top10.df,cen.sid.pos.uk1o.top10.df)
```

### Sids - UK2

```{r}
##uk2 inshore pre
cen.sid.pre.uk2i <- eigen_centrality(net.sid.pre.uk2i)$vector
cen.cen.sid.pre.uk2i.sorted <- sort(cen.sid.pre.uk2i,decreasing=TRUE)
cen.sid.pre.uk2i.top10 <- cen.cen.sid.pre.uk2i.sorted[1:10]

cen.sid.pre.uk2i.top10.df <- data.frame(cen.sid.pre.uk2i.top10)
cen.sid.pre.uk2i.top10.df$sqs <- row.names(cen.sid.pre.uk2i.top10.df)

cen.sid.pre.uk2i.top10.df$site <- rep("UK2",nrow(cen.sid.pre.uk2i.top10.df))
cen.sid.pre.uk2i.top10.df$zone <- rep("Inshore",nrow(cen.sid.pre.uk2i.top10.df))
cen.sid.pre.uk2i.top10.df$time <- rep("Pre",nrow(cen.sid.pre.uk2i.top10.df))

names(cen.sid.pre.uk2i.top10.df)[names(cen.sid.pre.uk2i.top10.df) == 'cen.sid.pre.uk2i.top10'] <- 'cent'

##uk2 offshore pre
cen.sid.pre.uk2o <- eigen_centrality(net.sid.pre.uk2o)$vector
cen.cen.sid.pre.uk2o.sorted <- sort(cen.sid.pre.uk2o,decreasing=TRUE)
cen.sid.pre.uk2o.top10 <- cen.cen.sid.pre.uk2o.sorted[1:10]

cen.sid.pre.uk2o.top10.df <- data.frame(cen.sid.pre.uk2o.top10)
cen.sid.pre.uk2o.top10.df$sqs <- row.names(cen.sid.pre.uk2o.top10.df)

cen.sid.pre.uk2o.top10.df$site <- rep("UK2",nrow(cen.sid.pre.uk2o.top10.df))
cen.sid.pre.uk2o.top10.df$zone <- rep("Offshore",nrow(cen.sid.pre.uk2o.top10.df))
cen.sid.pre.uk2o.top10.df$time <- rep("Pre",nrow(cen.sid.pre.uk2o.top10.df))

names(cen.sid.pre.uk2o.top10.df)[names(cen.sid.pre.uk2o.top10.df) == 'cen.sid.pre.uk2o.top10'] <- 'cent'

##uk2 inshore irm
cen.sid.irm.uk2i <- eigen_centrality(net.sid.irm.uk2i)$vector
cen.cen.sid.irm.uk2i.sorted <- sort(cen.sid.irm.uk2i,decreasing=TRUE)
cen.sid.irm.uk2i.top10 <- cen.cen.sid.irm.uk2i.sorted[1:10]

cen.sid.irm.uk2i.top10.df <- data.frame(cen.sid.irm.uk2i.top10)
cen.sid.irm.uk2i.top10.df$sqs <- row.names(cen.sid.irm.uk2i.top10.df)

cen.sid.irm.uk2i.top10.df$site <- rep("UK2",nrow(cen.sid.irm.uk2i.top10.df))
cen.sid.irm.uk2i.top10.df$zone <- rep("Inshore",nrow(cen.sid.irm.uk2i.top10.df))
cen.sid.irm.uk2i.top10.df$time <- rep("Irma",nrow(cen.sid.irm.uk2i.top10.df))

names(cen.sid.irm.uk2i.top10.df)[names(cen.sid.irm.uk2i.top10.df) == 'cen.sid.irm.uk2i.top10'] <- 'cent'

##uk2 offshore irm
cen.sid.irm.uk2o <- eigen_centrality(net.sid.irm.uk2o)$vector
cen.cen.sid.irm.uk2o.sorted <- sort(cen.sid.irm.uk2o,decreasing=TRUE)
cen.sid.irm.uk2o.top10 <- cen.cen.sid.irm.uk2o.sorted[1:10]

cen.sid.irm.uk2o.top10.df <- data.frame(cen.sid.irm.uk2o.top10)
cen.sid.irm.uk2o.top10.df$sqs <- row.names(cen.sid.irm.uk2o.top10.df)

cen.sid.irm.uk2o.top10.df$site <- rep("UK2",nrow(cen.sid.irm.uk2o.top10.df))
cen.sid.irm.uk2o.top10.df$zone <- rep("Offshore",nrow(cen.sid.irm.uk2o.top10.df))
cen.sid.irm.uk2o.top10.df$time <- rep("Irma",nrow(cen.sid.irm.uk2o.top10.df))

names(cen.sid.irm.uk2o.top10.df)[names(cen.sid.irm.uk2o.top10.df) == 'cen.sid.irm.uk2o.top10'] <- 'cent'

#ggplot(data=cen.sid.pre.uk2o.top10.df,aes(x=sqs,y=cen.sid.pre.uk2o.top10))+
#  geom_bar(stat="identity")

##uk2 inshore post
cen.sid.pos.uk2i <- eigen_centrality(net.sid.pos.uk2i)$vector
cen.cen.sid.pos.uk2i.sorted <- sort(cen.sid.pos.uk2i,decreasing=TRUE)
cen.sid.pos.uk2i.top10 <- cen.cen.sid.pos.uk2i.sorted[1:10]

cen.sid.pos.uk2i.top10.df <- data.frame(cen.sid.pos.uk2i.top10)
cen.sid.pos.uk2i.top10.df$sqs <- row.names(cen.sid.pos.uk2i.top10.df)

cen.sid.pos.uk2i.top10.df$site <- rep("UK2",nrow(cen.sid.pos.uk2i.top10.df))
cen.sid.pos.uk2i.top10.df$zone <- rep("Inshore",nrow(cen.sid.pos.uk2i.top10.df))
cen.sid.pos.uk2i.top10.df$time <- rep("Post",nrow(cen.sid.pos.uk2i.top10.df))

names(cen.sid.pos.uk2i.top10.df)[names(cen.sid.pos.uk2i.top10.df) == 'cen.sid.pos.uk2i.top10'] <- 'cent'

##uk2 offshore post
cen.sid.pos.uk2o <- eigen_centrality(net.sid.pos.uk2o)$vector
cen.cen.sid.pos.uk2o.sorted <- sort(cen.sid.pos.uk2o,decreasing=TRUE)
cen.sid.pos.uk2o.top10 <- cen.cen.sid.pos.uk2o.sorted[1:10]

cen.sid.pos.uk2o.top10.df <- data.frame(cen.sid.pos.uk2o.top10)
cen.sid.pos.uk2o.top10.df$sqs <- row.names(cen.sid.pos.uk2o.top10.df)

cen.sid.pos.uk2o.top10.df$site <- rep("UK2",nrow(cen.sid.pos.uk2o.top10.df))
cen.sid.pos.uk2o.top10.df$zone <- rep("Offshore",nrow(cen.sid.pos.uk2o.top10.df))
cen.sid.pos.uk2o.top10.df$time <- rep("Post",nrow(cen.sid.pos.uk2o.top10.df))

#ggplot(data=cen.sid.pre.uk2o.top10.df,aes(x=sqs,y=cen.sid.pre.uk2o.top10))+
#  geom_bar(stat="identity")

names(cen.sid.pos.uk2o.top10.df)[names(cen.sid.pos.uk2o.top10.df) == 'cen.sid.pos.uk2o.top10'] <- 'cent'

cen.sid.uk2 <- rbind(cen.sid.pre.uk2i.top10.df,cen.sid.pre.uk2o.top10.df,cen.sid.irm.uk2i.top10.df,cen.sid.irm.uk2o.top10.df,cen.sid.pos.uk2i.top10.df,cen.sid.pos.uk2o.top10.df)
```

### All the data & tax info - sids

```{r}
cen.sid <- rbind(cen.sid.lk1,cen.sid.uk1,cen.sid.uk2)
row.names(cen.sid) <- 1:nrow(cen.sid)

ps.clean.sid <- readRDS("./files/ps.clean.sid.no0")
tax.sid.df <- as.data.frame(ps.clean.sid@tax_table)
tax.sid.df$sqs <- row.names(tax.sid.df)

cen.sid.tax <- merge(tax.sid.df,cen.sid,by="sqs")

#saveRDS(cen.sid.tax,file="./files/eigen.centrality.sid.rds")
```

### Rads - lk1

```{r}
##LK1 inshore pre
cen.rad.pre.lk1i <- eigen_centrality(net.rad.pre.lk1i)$vector
cen.cen.rad.pre.lk1i.sorted <- sort(cen.rad.pre.lk1i,decreasing=TRUE)
cen.rad.pre.lk1i.top10 <- cen.cen.rad.pre.lk1i.sorted[1:10]

cen.rad.pre.lk1i.top10.df <- data.frame(cen.rad.pre.lk1i.top10)
cen.rad.pre.lk1i.top10.df$sqs <- row.names(cen.rad.pre.lk1i.top10.df)

cen.rad.pre.lk1i.top10.df$site <- rep("LK1",nrow(cen.rad.pre.lk1i.top10.df))
cen.rad.pre.lk1i.top10.df$zone <- rep("Inshore",nrow(cen.rad.pre.lk1i.top10.df))
cen.rad.pre.lk1i.top10.df$time <- rep("Pre",nrow(cen.rad.pre.lk1i.top10.df))

names(cen.rad.pre.lk1i.top10.df)[names(cen.rad.pre.lk1i.top10.df) == 'cen.rad.pre.lk1i.top10'] <- 'cent'

##LK1 offshore pre
cen.rad.pre.lk1o <- eigen_centrality(net.rad.pre.lk1o)$vector
cen.cen.rad.pre.lk1o.sorted <- sort(cen.rad.pre.lk1o,decreasing=TRUE)
cen.rad.pre.lk1o.top10 <- cen.cen.rad.pre.lk1o.sorted[1:10]

cen.rad.pre.lk1o.top10.df <- data.frame(cen.rad.pre.lk1o.top10)
cen.rad.pre.lk1o.top10.df$sqs <- row.names(cen.rad.pre.lk1o.top10.df)

cen.rad.pre.lk1o.top10.df$site <- rep("LK1",nrow(cen.rad.pre.lk1o.top10.df))
cen.rad.pre.lk1o.top10.df$zone <- rep("Offshore",nrow(cen.rad.pre.lk1o.top10.df))
cen.rad.pre.lk1o.top10.df$time <- rep("Pre",nrow(cen.rad.pre.lk1o.top10.df))

names(cen.rad.pre.lk1o.top10.df)[names(cen.rad.pre.lk1o.top10.df) == 'cen.rad.pre.lk1o.top10'] <- 'cent'

##LK1 inshore irm
cen.rad.irm.lk1i <- eigen_centrality(net.rad.irm.lk1i)$vector
cen.cen.rad.irm.lk1i.sorted <- sort(cen.rad.irm.lk1i,decreasing=TRUE)
cen.rad.irm.lk1i.top10 <- cen.cen.rad.irm.lk1i.sorted[1:10]

cen.rad.irm.lk1i.top10.df <- data.frame(cen.rad.irm.lk1i.top10)
cen.rad.irm.lk1i.top10.df$sqs <- row.names(cen.rad.irm.lk1i.top10.df)

cen.rad.irm.lk1i.top10.df$site <- rep("LK1",nrow(cen.rad.irm.lk1i.top10.df))
cen.rad.irm.lk1i.top10.df$zone <- rep("Inshore",nrow(cen.rad.irm.lk1i.top10.df))
cen.rad.irm.lk1i.top10.df$time <- rep("Irma",nrow(cen.rad.irm.lk1i.top10.df))

names(cen.rad.irm.lk1i.top10.df)[names(cen.rad.irm.lk1i.top10.df) == 'cen.rad.irm.lk1i.top10'] <- 'cent'

##LK1 offshore irm
cen.rad.irm.lk1o <- eigen_centrality(net.rad.irm.lk1o)$vector
cen.cen.rad.irm.lk1o.sorted <- sort(cen.rad.irm.lk1o,decreasing=TRUE)
cen.rad.irm.lk1o.top10 <- cen.cen.rad.irm.lk1o.sorted[1:10]

cen.rad.irm.lk1o.top10.df <- data.frame(cen.rad.irm.lk1o.top10)
cen.rad.irm.lk1o.top10.df$sqs <- row.names(cen.rad.irm.lk1o.top10.df)

cen.rad.irm.lk1o.top10.df$site <- rep("LK1",nrow(cen.rad.irm.lk1o.top10.df))
cen.rad.irm.lk1o.top10.df$zone <- rep("Offshore",nrow(cen.rad.irm.lk1o.top10.df))
cen.rad.irm.lk1o.top10.df$time <- rep("Irma",nrow(cen.rad.irm.lk1o.top10.df))

names(cen.rad.irm.lk1o.top10.df)[names(cen.rad.irm.lk1o.top10.df) == 'cen.rad.irm.lk1o.top10'] <- 'cent'

#ggplot(data=cen.rad.pre.lk1o.top10.df,aes(x=sqs,y=cen.rad.pre.lk1o.top10))+
#  geom_bar(stat="identity")

##LK1 inshore post
cen.rad.pos.lk1i <- eigen_centrality(net.rad.pos.lk1i)$vector
cen.cen.rad.pos.lk1i.sorted <- sort(cen.rad.pos.lk1i,decreasing=TRUE)
cen.rad.pos.lk1i.top10 <- cen.cen.rad.pos.lk1i.sorted[1:10]

cen.rad.pos.lk1i.top10.df <- data.frame(cen.rad.pos.lk1i.top10)
cen.rad.pos.lk1i.top10.df$sqs <- row.names(cen.rad.pos.lk1i.top10.df)

cen.rad.pos.lk1i.top10.df$site <- rep("LK1",nrow(cen.rad.pos.lk1i.top10.df))
cen.rad.pos.lk1i.top10.df$zone <- rep("Inshore",nrow(cen.rad.pos.lk1i.top10.df))
cen.rad.pos.lk1i.top10.df$time <- rep("Post",nrow(cen.rad.pos.lk1i.top10.df))

names(cen.rad.pos.lk1i.top10.df)[names(cen.rad.pos.lk1i.top10.df) == 'cen.rad.pos.lk1i.top10'] <- 'cent'

##LK1 offshore post
cen.rad.pos.lk1o <- eigen_centrality(net.rad.pos.lk1o)$vector
cen.cen.rad.pos.lk1o.sorted <- sort(cen.rad.pos.lk1o,decreasing=TRUE)
cen.rad.pos.lk1o.top10 <- cen.cen.rad.pos.lk1o.sorted[1:10]

cen.rad.pos.lk1o.top10.df <- data.frame(cen.rad.pos.lk1o.top10)
cen.rad.pos.lk1o.top10.df$sqs <- row.names(cen.rad.pos.lk1o.top10.df)

cen.rad.pos.lk1o.top10.df$site <- rep("LK1",nrow(cen.rad.pos.lk1o.top10.df))
cen.rad.pos.lk1o.top10.df$zone <- rep("Offshore",nrow(cen.rad.pos.lk1o.top10.df))
cen.rad.pos.lk1o.top10.df$time <- rep("Post",nrow(cen.rad.pos.lk1o.top10.df))

#ggplot(data=cen.rad.pre.lk1o.top10.df,aes(x=sqs,y=cen.rad.pre.lk1o.top10))+
#  geom_bar(stat="identity")

names(cen.rad.pos.lk1o.top10.df)[names(cen.rad.pos.lk1o.top10.df) == 'cen.rad.pos.lk1o.top10'] <- 'cent'

cen.rad.lk1 <- rbind(cen.rad.pre.lk1i.top10.df,cen.rad.pre.lk1o.top10.df,cen.rad.irm.lk1i.top10.df,cen.rad.irm.lk1o.top10.df,cen.rad.pos.lk1i.top10.df,cen.rad.pos.lk1o.top10.df)
```

### Rads - UK1

```{r}
##uk1 inshore pre
cen.rad.pre.uk1i <- eigen_centrality(net.rad.pre.uk1i)$vector
cen.cen.rad.pre.uk1i.sorted <- sort(cen.rad.pre.uk1i,decreasing=TRUE)
cen.rad.pre.uk1i.top10 <- cen.cen.rad.pre.uk1i.sorted[1:10]

cen.rad.pre.uk1i.top10.df <- data.frame(cen.rad.pre.uk1i.top10)
cen.rad.pre.uk1i.top10.df$sqs <- row.names(cen.rad.pre.uk1i.top10.df)

cen.rad.pre.uk1i.top10.df$site <- rep("UK1",nrow(cen.rad.pre.uk1i.top10.df))
cen.rad.pre.uk1i.top10.df$zone <- rep("Inshore",nrow(cen.rad.pre.uk1i.top10.df))
cen.rad.pre.uk1i.top10.df$time <- rep("Pre",nrow(cen.rad.pre.uk1i.top10.df))

names(cen.rad.pre.uk1i.top10.df)[names(cen.rad.pre.uk1i.top10.df) == 'cen.rad.pre.uk1i.top10'] <- 'cent'

##uk1 offshore pre
cen.rad.pre.uk1o <- eigen_centrality(net.rad.pre.uk1o)$vector
cen.cen.rad.pre.uk1o.sorted <- sort(cen.rad.pre.uk1o,decreasing=TRUE)
cen.rad.pre.uk1o.top10 <- cen.cen.rad.pre.uk1o.sorted[1:10]

cen.rad.pre.uk1o.top10.df <- data.frame(cen.rad.pre.uk1o.top10)
cen.rad.pre.uk1o.top10.df$sqs <- row.names(cen.rad.pre.uk1o.top10.df)

cen.rad.pre.uk1o.top10.df$site <- rep("UK1",nrow(cen.rad.pre.uk1o.top10.df))
cen.rad.pre.uk1o.top10.df$zone <- rep("Offshore",nrow(cen.rad.pre.uk1o.top10.df))
cen.rad.pre.uk1o.top10.df$time <- rep("Pre",nrow(cen.rad.pre.uk1o.top10.df))

names(cen.rad.pre.uk1o.top10.df)[names(cen.rad.pre.uk1o.top10.df) == 'cen.rad.pre.uk1o.top10'] <- 'cent'

##uk1 inshore irm
cen.rad.irm.uk1i <- eigen_centrality(net.rad.irm.uk1i)$vector
cen.cen.rad.irm.uk1i.sorted <- sort(cen.rad.irm.uk1i,decreasing=TRUE)
cen.rad.irm.uk1i.top10 <- cen.cen.rad.irm.uk1i.sorted[1:10]

cen.rad.irm.uk1i.top10.df <- data.frame(cen.rad.irm.uk1i.top10)
cen.rad.irm.uk1i.top10.df$sqs <- row.names(cen.rad.irm.uk1i.top10.df)

cen.rad.irm.uk1i.top10.df$site <- rep("UK1",nrow(cen.rad.irm.uk1i.top10.df))
cen.rad.irm.uk1i.top10.df$zone <- rep("Inshore",nrow(cen.rad.irm.uk1i.top10.df))
cen.rad.irm.uk1i.top10.df$time <- rep("Irma",nrow(cen.rad.irm.uk1i.top10.df))

names(cen.rad.irm.uk1i.top10.df)[names(cen.rad.irm.uk1i.top10.df) == 'cen.rad.irm.uk1i.top10'] <- 'cent'

cen.rad.uk1 <- rbind(cen.rad.pre.uk1i.top10.df,cen.rad.pre.uk1o.top10.df,cen.rad.irm.uk1i.top10.df)
```

### Rads - UK2

```{r}
##uk2 inshore pre
cen.rad.pre.uk2i <- eigen_centrality(net.rad.pre.uk2i)$vector
cen.cen.rad.pre.uk2i.sorted <- sort(cen.rad.pre.uk2i,decreasing=TRUE)
cen.rad.pre.uk2i.top10 <- cen.cen.rad.pre.uk2i.sorted[1:10]

cen.rad.pre.uk2i.top10.df <- data.frame(cen.rad.pre.uk2i.top10)
cen.rad.pre.uk2i.top10.df$sqs <- row.names(cen.rad.pre.uk2i.top10.df)

cen.rad.pre.uk2i.top10.df$site <- rep("UK2",nrow(cen.rad.pre.uk2i.top10.df))
cen.rad.pre.uk2i.top10.df$zone <- rep("Inshore",nrow(cen.rad.pre.uk2i.top10.df))
cen.rad.pre.uk2i.top10.df$time <- rep("Pre",nrow(cen.rad.pre.uk2i.top10.df))

names(cen.rad.pre.uk2i.top10.df)[names(cen.rad.pre.uk2i.top10.df) == 'cen.rad.pre.uk2i.top10'] <- 'cent'

##uk2 offshore pre
cen.rad.pre.uk2o <- eigen_centrality(net.rad.pre.uk2o)$vector
cen.cen.rad.pre.uk2o.sorted <- sort(cen.rad.pre.uk2o,decreasing=TRUE)
cen.rad.pre.uk2o.top10 <- cen.cen.rad.pre.uk2o.sorted[1:10]

cen.rad.pre.uk2o.top10.df <- data.frame(cen.rad.pre.uk2o.top10)
cen.rad.pre.uk2o.top10.df$sqs <- row.names(cen.rad.pre.uk2o.top10.df)

cen.rad.pre.uk2o.top10.df$site <- rep("UK2",nrow(cen.rad.pre.uk2o.top10.df))
cen.rad.pre.uk2o.top10.df$zone <- rep("Offshore",nrow(cen.rad.pre.uk2o.top10.df))
cen.rad.pre.uk2o.top10.df$time <- rep("Pre",nrow(cen.rad.pre.uk2o.top10.df))

names(cen.rad.pre.uk2o.top10.df)[names(cen.rad.pre.uk2o.top10.df) == 'cen.rad.pre.uk2o.top10'] <- 'cent'

##uk2 inshore irm
cen.rad.irm.uk2i <- eigen_centrality(net.rad.irm.uk2i)$vector
cen.cen.rad.irm.uk2i.sorted <- sort(cen.rad.irm.uk2i,decreasing=TRUE)
cen.rad.irm.uk2i.top10 <- cen.cen.rad.irm.uk2i.sorted[1:10]

cen.rad.irm.uk2i.top10.df <- data.frame(cen.rad.irm.uk2i.top10)
cen.rad.irm.uk2i.top10.df$sqs <- row.names(cen.rad.irm.uk2i.top10.df)

cen.rad.irm.uk2i.top10.df$site <- rep("UK2",nrow(cen.rad.irm.uk2i.top10.df))
cen.rad.irm.uk2i.top10.df$zone <- rep("Inshore",nrow(cen.rad.irm.uk2i.top10.df))
cen.rad.irm.uk2i.top10.df$time <- rep("Irma",nrow(cen.rad.irm.uk2i.top10.df))

names(cen.rad.irm.uk2i.top10.df)[names(cen.rad.irm.uk2i.top10.df) == 'cen.rad.irm.uk2i.top10'] <- 'cent'

##uk2 offshore irm
cen.rad.irm.uk2o <- eigen_centrality(net.rad.irm.uk2o)$vector
cen.cen.rad.irm.uk2o.sorted <- sort(cen.rad.irm.uk2o,decreasing=TRUE)
cen.rad.irm.uk2o.top10 <- cen.cen.rad.irm.uk2o.sorted[1:10]

cen.rad.irm.uk2o.top10.df <- data.frame(cen.rad.irm.uk2o.top10)
cen.rad.irm.uk2o.top10.df$sqs <- row.names(cen.rad.irm.uk2o.top10.df)

cen.rad.irm.uk2o.top10.df$site <- rep("UK2",nrow(cen.rad.irm.uk2o.top10.df))
cen.rad.irm.uk2o.top10.df$zone <- rep("Offshore",nrow(cen.rad.irm.uk2o.top10.df))
cen.rad.irm.uk2o.top10.df$time <- rep("Irma",nrow(cen.rad.irm.uk2o.top10.df))

names(cen.rad.irm.uk2o.top10.df)[names(cen.rad.irm.uk2o.top10.df) == 'cen.rad.irm.uk2o.top10'] <- 'cent'

#ggplot(data=cen.rad.pre.uk2o.top10.df,aes(x=sqs,y=cen.rad.pre.uk2o.top10))+
#  geom_bar(stat="identity")

##uk2 inshore post
cen.rad.pos.uk2i <- eigen_centrality(net.rad.pos.uk2i)$vector
cen.cen.rad.pos.uk2i.sorted <- sort(cen.rad.pos.uk2i,decreasing=TRUE)
cen.rad.pos.uk2i.top10 <- cen.cen.rad.pos.uk2i.sorted[1:10]

cen.rad.pos.uk2i.top10.df <- data.frame(cen.rad.pos.uk2i.top10)
cen.rad.pos.uk2i.top10.df$sqs <- row.names(cen.rad.pos.uk2i.top10.df)

cen.rad.pos.uk2i.top10.df$site <- rep("UK2",nrow(cen.rad.pos.uk2i.top10.df))
cen.rad.pos.uk2i.top10.df$zone <- rep("Inshore",nrow(cen.rad.pos.uk2i.top10.df))
cen.rad.pos.uk2i.top10.df$time <- rep("Post",nrow(cen.rad.pos.uk2i.top10.df))

names(cen.rad.pos.uk2i.top10.df)[names(cen.rad.pos.uk2i.top10.df) == 'cen.rad.pos.uk2i.top10'] <- 'cent'

##uk2 offshore post
cen.rad.pos.uk2o <- eigen_centrality(net.rad.pos.uk2o)$vector
cen.cen.rad.pos.uk2o.sorted <- sort(cen.rad.pos.uk2o,decreasing=TRUE)
cen.rad.pos.uk2o.top10 <- cen.cen.rad.pos.uk2o.sorted[1:10]

cen.rad.pos.uk2o.top10.df <- data.frame(cen.rad.pos.uk2o.top10)
cen.rad.pos.uk2o.top10.df$sqs <- row.names(cen.rad.pos.uk2o.top10.df)

cen.rad.pos.uk2o.top10.df$site <- rep("UK2",nrow(cen.rad.pos.uk2o.top10.df))
cen.rad.pos.uk2o.top10.df$zone <- rep("Offshore",nrow(cen.rad.pos.uk2o.top10.df))
cen.rad.pos.uk2o.top10.df$time <- rep("Post",nrow(cen.rad.pos.uk2o.top10.df))

#ggplot(data=cen.rad.pre.uk2o.top10.df,aes(x=sqs,y=cen.rad.pre.uk2o.top10))+
#  geom_bar(stat="identity")

names(cen.rad.pos.uk2o.top10.df)[names(cen.rad.pos.uk2o.top10.df) == 'cen.rad.pos.uk2o.top10'] <- 'cent'

cen.rad.uk2 <- rbind(cen.rad.pre.uk2i.top10.df,cen.rad.pre.uk2o.top10.df,cen.rad.irm.uk2i.top10.df,cen.rad.irm.uk2o.top10.df,cen.rad.pos.uk2i.top10.df,cen.rad.pos.uk2o.top10.df)
```

### All the data & tax info - rads

```{r}
cen.rad <- rbind(cen.rad.lk1,cen.rad.uk1,cen.rad.uk2)
row.names(cen.rad) <- 1:nrow(cen.rad)

ps.clean.rad <- readRDS("./files/ps.clean.rad.no0")
tax.rad.df <- as.data.frame(ps.clean.rad@tax_table)
tax.rad.df$sqs <- row.names(tax.rad.df)

cen.rad.tax <- merge(tax.rad.df,cen.rad,by="sqs")

#saveRDS(cen.rad.tax,file="./files/eigen.centrality.rad.rds")
```

## Eigen centrality results{.tabset}

### Setup

```{r eigen data}
library("ggpubr")
library("plyr")
#library("dplyr")
#library("tidyverse")

setwd("/Volumes/GoogleDrive/My Drive/Flirma/flirma_networks/fl_16s/04.networks")

cen.sid.tax <- readRDS("./files/eigen.centrality.sid.rds")
cen.rad.tax <- readRDS("./files/eigen.centrality.rad.rds")

cen.sid.tax$time <- factor(cen.sid.tax$time,levels=c("Pre","Irma","Post"))
cen.rad.tax$time <- factor(cen.rad.tax$time,levels=c("Pre","Irma","Post"))

cen.sid.tax$index <- row.names(cen.sid.tax)
cen.rad.tax$index <- row.names(cen.rad.tax)

cen.sid.tax$full_sq <- paste0(cen.sid.tax$Family,"_",cen.sid.tax$index)
cen.rad.tax$full_sq <- paste0(cen.rad.tax$Family,"_",cen.rad.tax$index)

#write.csv(cen.sid.tax,"cen.sid.tax.csv")
#write.csv(cen.rad.tax,"cen.rad.tax.csv")
```

Histogram of taxa info

```{r}
ggplot(cen.sid.tax,aes(x=Family))+
  geom_histogram(stat="count")+
  facet_grid(time~.)
```

### Plotting - sids LK1

Note: I re-did how I did the indexing, so LK1 would have to be redone here as for the other sites if I wanted to plot it again

```{r}
cen.sid.tax.lk1 <- subset(cen.sid.tax,site=="LK1")
cen.sid.tax.lk1i <- subset(cen.sid.tax.lk1,zone=="Inshore")
cen.sid.tax.lk1o <- subset(cen.sid.tax.lk1,zone=="Offshore")

#darkgray = resilient?
#black = dies out during Irma

fam.freq.table <- count(cen.sid.tax.lk1i$Family)
fam.freq.table[fam.freq.table$freq>1,]

#                            x freq
# 4  Class_Gammaproteobacteria    2 #resilient?
# 12          Kingdom_Bacteria    2 #both in post
# 14          Nitrosococcaceae    2 #both in Irma.. 

cen.sid.tax.lk1i <- mutate(cen.sid.tax.lk1i, Conditions = case_when(
  full_sq == "Class_Gammaproteobacteria_sq2207" ~ "Pre & post",
  full_sq == "Class_Gammaproteobacteria_sq10649" ~ "Pre & post",
  TRUE ~ "NA"))

bar.lk1i <- ggplot(cen.sid.tax.lk1i,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Inshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  #scale_color_manual(values=c("#585858","darkgray"))+
  scale_fill_manual(values=c("#585858","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.lk1i

fam.freq.table <- count(cen.sid.tax.lk1o$Family)
fam.freq.table[fam.freq.table$freq>1,]

#                     x freq
# 8  Desulfobacteraceae    2 #both in Irma.. 
# 9   Flavobacteriaceae    2 #in Pre & Irma
# 21   Phycisphaeraceae    4 #twice in pre, once in Irma, once in post

cen.sid.tax.lk1o <- mutate(cen.sid.tax.lk1o, Conditions = case_when(
  full_sq == "Flavobacteriaceae_sq3691" ~ "Pre & Irma",
  full_sq == "Flavobacteriaceae_sq1302" ~ "Pre & Irma",
  full_sq == "Phycisphaeraceae_sq1645" ~ "All",
  full_sq == "Phycisphaeraceae_sq6751" ~ "All",
  full_sq == "Phycisphaeraceae_sq848" ~ "All",
  full_sq == "Phycisphaeraceae_sq1043" ~ "All",
  TRUE ~ "NA"))

bar.lk1o <- ggplot(cen.sid.tax.lk1o,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Offshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("black","#585858","lightgray"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.lk1o

bar.lk1 <- ggarrange(bar.lk1i,bar.lk1o,nrow=2,ncol=1,align="hv",legend="bottom")
annotate_figure(bar.lk1,top=text_grob("S. siderea - Lower Keys 1",size=16))

#ggsave(file="bar.eigen.cent.sid.lk1.pdf",width=8.5,height=6.5)
```

### Sids UK1

```{r}
cen.sid.tax.uk1 <- subset(cen.sid.tax,site=="UK1")
cen.sid.tax.uk1i <- subset(cen.sid.tax.uk1,zone=="Inshore")
cen.sid.tax.uk1o <- subset(cen.sid.tax.uk1,zone=="Offshore")

fam.freq.table <- count(cen.sid.tax.uk1i$Family)
fam.freq.table[fam.freq.table$freq>1,]
#                    x freq
# 6        Class_OM190    2 #Irma & post
# 8  Flavobacteriaceae    2 #both Irma
# 23       Woeseiaceae    5 #Irma & post

cen.sid.tax.uk1i <- mutate(cen.sid.tax.uk1i, Conditions = case_when(
  Family == "Class_OM190" ~ "Irma & post",
  Family == "Woeseiaceae" ~ "Irma & post",
  TRUE ~ "NA"))

bar.uk1i <- ggplot(cen.sid.tax.uk1i,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Inshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("darkgray","#585858"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk1i

fam.freq.table <- count(cen.sid.tax.uk1o$Family)
fam.freq.table[fam.freq.table$freq>1,]

#                       x freq
# 8     Flavobacteriaceae    2 #pre & Irma
# 11        Oleiphilaceae    2 #both in Irma
# 18 Saccharospirillaceae    3 #3 in Irma
# 24       Thiotrichaceae    2 #resilient, pre & post

cen.sid.tax.uk1o <- mutate(cen.sid.tax.uk1o, Conditions = case_when(
  Family == "Thiotrichaceae" ~ "Pre & post",
  Family == "Flavobacteriaceae" ~ "Pre & Irma",
  TRUE ~ "NA"))

bar.uk1o <- ggplot(cen.sid.tax.uk1o,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Offshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("#585858","lightgray","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk1o

bar.uk1 <- ggarrange(bar.uk1i,bar.uk1o,nrow=2,ncol=1,align="hv",legend="bottom")
annotate_figure(bar.uk1,top=text_grob("S. siderea - Upper Keys 1",size=16))

#ggsave(file="bar.eigen.cent.sid.uk1.pdf",width=8.5,height=6.5)
```

### Sids UK2

```{r}
cen.sid.tax.uk2 <- subset(cen.sid.tax,site=="UK2")
cen.sid.tax.uk2i <- subset(cen.sid.tax.uk2,zone=="Inshore")
cen.sid.tax.uk2o <- subset(cen.sid.tax.uk2,zone=="Offshore")

fam.freq.table <- count(cen.sid.tax.uk2i$Family)
fam.freq.table[fam.freq.table$freq>1,]
#                            x freq
# 3  Class_Gammaproteobacteria    2 #irm & post
# 5          Flavobacteriaceae    3 #All
# 13   Order_Thalassobaculales    5 #irm & post
# 21              Vibrionaceae    2 #both in pre

cen.sid.tax.uk2i <- mutate(cen.sid.tax.uk2i, Conditions = case_when(
  Family == "Flavobacteriaceae" ~ "All",
  Family == "Class_Gammaproteobacteria" ~ "Irma & post",
  Family == "Order_Thalassobaculales" ~ "Irma & post",
  TRUE ~ "NA"))

bar.uk2i <- ggplot(cen.sid.tax.uk2i,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Inshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("black","darkgray","#585858"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk2i

fam.freq.table <- count(cen.sid.tax.uk2o$Family)
fam.freq.table[fam.freq.table$freq>1,]
#                          x freq
# 6       Desulfosarcinaceae    2 #pre & post - resilient
# 9           Kiloniellaceae    3 #all
# 15 Order_Thalassobaculales    4 #all
# 16            Phylum_NB1-j    2 #Irma & post
# 20             Woeseiaceae    3 #pre & post - resilient

cen.sid.tax.uk2o <- mutate(cen.sid.tax.uk2o, Conditions = case_when(
  Family == "Kiloniellaceae" ~ "All",
  Family == "Order_Thalassobaculales" ~ "All",
  Family == "Phylum_NB1-j" ~ "Irma & post",
  Family == "Desulfosarcinaceae" ~ "Pre & post",
  Family == "Woeseiaceae" ~ "Pre & post",
  TRUE ~ "NA"))

bar.uk2o <- ggplot(cen.sid.tax.uk2o,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Offshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("black","darkgray","#585858","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk2o

bar.uk2 <- ggarrange(bar.uk2i,bar.uk2o,nrow=2,ncol=1,align="hv",legend="bottom")
annotate_figure(bar.uk2,top=text_grob("S. siderea - Upper Keys 2",size=16))

#ggsave(file="bar.eigen.cent.sid.uk2.pdf",width=8.5,height=6.5)
```

### Plotting - rads LK1

```{r}
cen.rad.tax.lk1 <- subset(cen.rad.tax,site=="LK1")
cen.rad.tax.lk1i <- subset(cen.rad.tax.lk1,zone=="Inshore")
cen.rad.tax.lk1o <- subset(cen.rad.tax.lk1,zone=="Offshore")

#darkgray = resilient?
#black = dies out during Irma

fam.freq.table <- plyr::count(cen.rad.tax.lk1i$Family)
fam.freq.table[fam.freq.table$freq>1,]

# 15   Nitrosococcaceae    2 #both in Irma
# 17 Order_SAR202 clade    2 #pre & Irma
# 21      Pirellulaceae    3 #all 3 in post
# 22   Rhodobacteraceae    2 #pre & post

cen.rad.tax.lk1i <- mutate(cen.rad.tax.lk1i, Conditions = case_when(
  Family == "Order_SAR202 clade" ~ "Pre & Irma",
  Family == "Rhodobacteraceae" ~ "Pre & post",
  TRUE ~ "NA"))

bar.lk1i <- ggplot(cen.rad.tax.lk1i,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Inshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  #scale_color_manual(values=c("#585858","darkgray"))+
  scale_fill_manual(values=c("#585858","lightgray","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.lk1i

fam.freq.table <- plyr::count(cen.rad.tax.lk1o$Family)
fam.freq.table[fam.freq.table$freq>1,]
#                          x freq
# 4        Cyclobacteriaceae    3 #1 in pre, 2 in post
# 6        Flavobacteriaceae    2 #both in pre
# 9           Kiloniellaceae    2 #both in post
# 13 Order_Thalassobaculales    5 #1 in pre, 4 in post???
# 14        Phormidesmiaceae    3 #pre & Irma

cen.rad.tax.lk1o <- mutate(cen.rad.tax.lk1o, Conditions = case_when(
  Family == "Cyclobacteriaceae" ~ "Pre & post",
  Family == "Order_Thalassobaculales" ~ "Pre & post",
  Family == "Phormidesmiaceae" ~ "Pre & Irma",
  TRUE ~ "NA"))

bar.lk1o <- ggplot(cen.rad.tax.lk1o,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Offshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("#585858","lightgray","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.lk1o

bar.lk1 <- ggarrange(bar.lk1i,bar.lk1o,nrow=2,ncol=1,align="hv",legend="bottom")
annotate_figure(bar.lk1,top=text_grob("S. radians - Lower Keys 1",size=16))

#ggsave(file="bar.eigen.cent.rad.lk1.pdf",width=8.5,height=6.5)
```

### Rads uk1

```{r}
cen.rad.tax.uk1 <- subset(cen.rad.tax,site=="UK1")
cen.rad.tax.uk1i <- subset(cen.rad.tax.uk1,zone=="Inshore")
cen.rad.tax.uk1o <- subset(cen.rad.tax.uk1,zone=="Offshore")

fam.freq.table <- plyr::count(cen.rad.tax.uk1i$Family)
fam.freq.table[fam.freq.table$freq>1,]
#                          x freq
# 6        Flavobacteriaceae    2 #2 in pre
# 9  Order_Thalassobaculales    4 #Pre & Irma
# 14             Woeseiaceae    3 #Pre & Irma

cen.rad.tax.uk1i <- mutate(cen.rad.tax.uk1i, Conditions = case_when(
  Family == "Order_Thalassobaculales" ~ "Pre & Irma",
  Family == "Woeseiaceae" ~ "Pre & Irma",
  TRUE ~ "NA"))

bar.uk1i <- ggplot(cen.rad.tax.uk1i,aes(x=cent,y=reorder(full_sq,cent),color=Conditions,fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Inshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_color_manual(values=c("#585858","lightgray"))+
  scale_fill_manual(values=c("#585858","lightgray"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk1i

fam.freq.table <- plyr::count(cen.rad.tax.uk1o$Family)
fam.freq.table[fam.freq.table$freq>1,]

# nada - only 1 time point

cen.rad.tax.uk1o <- mutate(cen.rad.tax.uk1o, Conditions = case_when(
  TRUE ~ "NA"))

bar.uk1o <- ggplot(cen.rad.tax.uk1o,aes(x=cent,y=reorder(full_sq,cent),color=Conditions,fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Offshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_color_manual(values=c("#585858"))+
  scale_fill_manual(values=c("#585858"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk1o

bar.uk1 <- ggarrange(bar.uk1i,bar.uk1o,nrow=2,ncol=1,align="hv",legend="bottom")
annotate_figure(bar.uk1,top=text_grob("S. radians - Upper Keys 1",size=16))

ggsave(file="bar.eigen.cent.rad.uk1.pdf",width=8.5,height=6.5)
```

### Rads uk2

```{r}
cen.rad.tax.uk2 <- subset(cen.rad.tax,site=="UK2")
cen.rad.tax.uk2i <- subset(cen.rad.tax.uk2,zone=="Inshore")
cen.rad.tax.uk2o <- subset(cen.rad.tax.uk2,zone=="Offshore")

fam.freq.table <- plyr::count(cen.rad.tax.uk2i$Family)
fam.freq.table[fam.freq.table$freq>1,]
#                            x freq
# 3  Class_Gammaproteobacteria    2 #both in Pre
# 4          Cyclobacteriaceae    2 #Irma & post
# 5          Flavobacteriaceae    3 #all in Irma
# 6           Kordiimonadaceae    2 #both in Irma
# 8            Nodosilineaceae    2 #Irma & post
# 14   Order_Thalassobaculales    5 #all in post O.o
# 16          Puniceicoccaceae    2 #both in Irma

cen.rad.tax.uk2i <- mutate(cen.rad.tax.uk2i, Conditions = case_when(
  Family == "Cyclobacteriaceae" ~ "Irma & post",
  Family == "Nodosilineaceae" ~ "Irma & post",
  TRUE ~ "NA"))

bar.uk2i <- ggplot(cen.rad.tax.uk2i,aes(x=cent,y=reorder(full_sq,cent),color=Conditions,fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Inshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_color_manual(values=c("darkgray","#585858"))+
  scale_fill_manual(values=c("darkgray","#585858"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk2i
#                              x freq
# 10 Eurycoccales Incertae Sedis    2 #both in post
# 14             Nodosilineaceae    3 #pre & post
# 19     Order_Thalassobaculales    3 #pre & post

cen.rad.tax.uk2o <- mutate(cen.rad.tax.uk2o, Conditions = case_when(
  Family == "Nodosilineaceae" ~ "Pre & post",
  Family == "Order_Thalassobaculales" ~ "Pre & post",
  TRUE ~ "NA"))

bar.uk2o <- ggplot(cen.rad.tax.uk2o,aes(x=cent,y=reorder(full_sq,cent),color=Conditions,fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Offshore")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_color_manual(values=c("#585858","white"))+
  scale_fill_manual(values=c("#585858","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1))
bar.uk2o

bar.uk2 <- ggarrange(bar.uk2i,bar.uk2o,nrow=2,ncol=1,align="hv",legend="bottom")
annotate_figure(bar.uk2,top=text_grob("S. radians - Upper Keys 2",size=16))

#ggsave(file="bar.eigen.cent.rad.uk2.pdf",width=8.5,height=6.5)
```

Just generating a fake legend

```{r fake color legend}
cen.rad.tax.lk1i$Family

cen.rad.tax.lk1i <- mutate(cen.rad.tax.lk1i, Conditions = case_when(
  Family == "Microtrichaceae" ~ "All",
  Family == "Fokiniaceae" ~ "Irma & post",
  Family == "Rhodobacteraceae" ~ "Pre & Irma",
  Family == "Woeseiaceae" ~ "Pre & post",
  TRUE ~ "NA"))

bar.fake <- ggplot(cen.rad.tax.lk1i,aes(x=cent,y=reorder(full_sq,cent),fill=Conditions))+
  geom_bar(stat="identity",color="black")+
  facet_wrap(.~time,scales="free")+
  theme_bw()+
  ggtitle("Fake, just for legend")+
  xlab("Eigenvector centrality")+
  ylab(" ")+
  coord_cartesian(xlim=c(0.4,1))+
  #ylab("Eigenvector centrality")+
  scale_fill_manual(values=c("black","darkgray","#585858","lightgray","white"))+
  theme(axis.text.x=element_text(angle=90,vjust=1),legend.position="bottom")
bar.fake
```

## Bubble visualization

```{r}
ggplot(cen.sid.tax.lk1i, aes(x = time,y=Order)) + 
  geom_point(aes(size = cent, fill = Order), alpha = 0.75, shape = 21) + 
  labs( x= "", y = "", size = "Relative Abundance (%)", fill = "")  + 
  theme(legend.key=element_blank(), 
  axis.text.x = element_text(colour = "black", size = 12, face = "bold", angle = 90, vjust = 0.3, hjust = 1), 
  axis.text.y = element_text(colour = "black", face = "bold", size = 11), 
  legend.position = "right")+
  facet_wrap(~zone,scales="free_y")

ggplot(cen.sid.tax.lk1o, aes(x = time,y=Family)) + 
  geom_point(aes(size = cent, fill = Order), alpha = 0.75, shape = 21) + 
  #scale_size_continuous(limits = c(0.01, 1)) + 
  labs( x= "", y = "", size = "Relative Abundance (%)", fill = "")  + 
  theme(legend.key=element_blank(), 
  axis.text.x = element_text(colour = "black", size = 12, face = "bold", angle = 90, vjust = 0.3, hjust = 1), 
  axis.text.y = element_text(colour = "black", face = "bold", size = 11), 
  #legend.text = element_text(size = 10, face ="bold", colour ="black"), 
  #legend.title = element_text(size = 12, face = "bold"), 
  #panel.background = element_blank(), panel.border = element_rect(colour = "black", fill = NA, size = 1.2), 
  legend.position = "right")+
  facet_wrap(~zone,scales="free_y")
```

## Degree distribution

```{r}
# Degree distribution
deg.dist <- degree_distribution(net.fam.sid.pre.lk1i, mode = "all", cumulative = T) # Plot degree distribution
num <- (1:length(deg.dist))
treat <- rep("sid.pre.lk1i",length(deg.dist))
deg.sid.pre.lk1i <- data.frame(deg.dist,num,treat)

deg.dist <- degree_distribution(net.fam.sid.pre.lk1o, mode = "all", cumulative = T) # Plot degree distribution
num <- (1:length(deg.dist))
treat <- rep("sid.pre.lk1o",length(deg.dist))
deg.sid.pre.lk1o <- data.frame(deg.dist,num,treat)

deg.sid.pre.lk1 <- rbind(deg.sid.pre.lk1i,deg.sid.pre.lk1o)

#raw
ggplot(deg.sid.pre.lk1,aes(x=num,y=deg.dist,color=treat))+
  geom_point()

# Degree distribution
deg.dist <- degree_distribution(net.fam.sid.pre.lk1i,mode="all", cumulative=F) # Plot degree distribution
num <- (1:length(deg.dist))
treat <- rep("sid.pre.lk1i",length(deg.dist))
deg.sid.pre.lk1i <- data.frame(deg.dist,num,treat)

deg.dist <- degree_distribution(net.fam.sid.pre.lk1o, mode = "all", cumulative = T) # Plot degree distribution
num <- (1:length(deg.dist))
treat <- rep("sid.pre.lk1o",length(deg.dist))
deg.sid.pre.lk1o <- data.frame(deg.dist,num,treat)

ggplot(deg.sid.pre.lk1,aes(x=num,y=deg.dist,color=treat))+
  geom_point()

#now log
deg.sid.pre.lk1$deg.dist.log <- log(deg.sid.pre.lk1$deg.dist)
ggplot(deg.sid.pre.lk1,aes(x=treat,y=deg.dist.log,color=treat))+
  geom_boxplot()+
  geom_jitter()

ggplot(deg.sid.pre.lk1,aes(x=num,y=deg.dist.log,color=treat))+
  geom_point()
```

```{r}
btn.sid.lk1i.15 <- igraph::betweenness(net_sid.lk1i.15)
btn.sid.lk1i.15.sorted <- sort(btn.sid.lk1i.15,decreasing=TRUE)
btn.sid.lk1i.15.top10 <- btn.sid.lk1i.15.sorted[1:10]

btn.sid.lk1o.15 <- igraph::betweenness(net_sid.lk1o.15)
btn.sid.lk1o.15.sorted <- sort(btn.sid.lk1o.15,decreasing=TRUE)
btn.sid.lk1o.15.top10 <- btn.sid.lk1o.15.sorted[1:10]

names(btn.sid.lk1i.15.top10) %in% names(btn.sid.lk1o.15.top10)

btn.sid.lk1i.17 <- igraph::betweenness(net_sid.lk1i.17)
btn.sid.lk1i.17.sorted <- sort(btn.sid.lk1i.17,decreasing=TRUE)
btn.sid.lk1i.17.top10 <- btn.sid.lk1i.17.sorted[1:10]

btn.sid.lk1o.17 <- igraph::betweenness(net_sid.lk1o.17)
btn.sid.lk1o.17.sorted <- sort(btn.sid.lk1o.17,decreasing=TRUE)
btn.sid.lk1o.17.top10 <- btn.sid.lk1o.17.sorted[1:10]

names(btn.sid.lk1i.17.top10) %in% names(btn.sid.lk1o.17.top10)

btn.sid.lk1i.18 <- igraph::betweenness(net_sid.lk1i.18)
btn.sid.lk1i.18.sorted <- sort(btn.sid.lk1i.18,decreasing=TRUE)
btn.sid.lk1i.18.top10 <- btn.sid.lk1i.18.sorted[1:10]

btn.sid.lk1o.18 <- igraph::betweenness(net_sid.lk1o.18)
btn.sid.lk1o.18.sorted <- sort(btn.sid.lk1o.18,decreasing=TRUE)
btn.sid.lk1o.18.top10 <- btn.sid.lk1o.18.sorted[1:10]

names(btn.sid.lk1i.18.top10) %in% names(btn.sid.lk1o.18.top10)

#17 v 18
names(btn.sid.lk1i.18.top10) %in% names(btn.sid.lk1i.17.top10)

#18 v 15
names(btn.sid.lk1i.18.top10) %in% names(btn.sid.lk1i.15.top10)

#17 v 15
names(btn.sid.lk1i.17.top10) %in% names(btn.sid.lk1i.15.top10)

btn.sid.lk1i.17.top10.df <- data.frame(btn.sid.lk1i.17.top10)
btn.sid.lk1i.17.top10.df$sqs <- row.names(btn.sid.lk1i.17.top10.df)

btn.sid.lk1i.15.top10.df <- data.frame(btn.sid.lk1i.15.top10)
btn.sid.lk1i.15.top10.df$sqs <- row.names(btn.sid.lk1i.15.top10.df)

ggplot(btn.sid.lk1i.15.top10.df,aes(x=sqs,y=btn.sid.lk1i.15.top10))+
  geom_bar(stat="identity")

ggplot(btn.sid.lk1i.17.top10.df,aes(x=sqs,y=btn.sid.lk1i.17.top10))+
  geom_bar(stat="identity")

ggplot(btn.sid.lk1i.17.top10.df,aes(x=sqs,y=btn.sid.lk1i.17.top10))+
  geom_bar(stat="identity")
ggplot(btn.sid.lk1i.15.top10.df,aes(x=sqs,y=btn.sid.lk1i.17.top10))+
  geom_bar(stat="identity")

ggplot(btn.sid.lk1i.17.top10.df,aes(x=row.names,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Eigenvector centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2015 & 2016 (pre-Irma)")+
  geom_hline(yintercept=0.7885872,color="#781C6D")


btwn.15.tosort$vector <- btwn.15.tosort$betweenness.net_15.
btwn.15.sorted <- btwn.15.tosort[order(-btwn.15.tosort$vector),]
btwn.15.sorted$sqs <- rownames(btwn.15.sorted)
btwn.15.top10 <- btwn.15.sorted[1:10,]
sqs_order <- btwn.15.top10$sqs
btwn.15.top10$sqs <- factor(btwn.15.top10$sqs,levels=sqs_order)



plot(deg.dist, xlab = "Nodes degree", ylab = "Probability") 
lines(deg.dist)
# qgraph method
centralityPlot(net_sid.lk1i.15)
```

```{r older}
# Hub detection
#net_15.cn <- closeness(net_15)
#net_15.bn <- betweenness(net_15) 
#net_15.pr <- page_rank(net_15)$vector 
net_sid.lk1i.15.hs <- hub_score(net_sid.lk1i.15)$vector
net_sid.lk1i.15.hs.sort <- sort(net_sid.lk1i.15.hs, decreasing = TRUE)
net_sid.lk1i.15.hs.top5 <- head(net_sid.lk1i.15.hs.sort, n = 5)
net_sid.lk1i.15.hs.top5

net_17.cn <- closeness(net_17)
net_17.bn <- betweenness(net_17) 
net_17.pr <- page_rank(net_17)$vector
net_17.hs <- hub_score(net_17)$vector
net_17.hs.sort <- sort(net_17.hs, decreasing = TRUE)
net_17.hs.top5 <- head(net_17.hs.sort, n = 5)

net_18.cn <- closeness(net_18)
net_18.bn <- betweenness(net_18) 
net_18.pr <- page_rank(net_18)$vector 
net_18.hs <- hub_score(net_18)$vector
net_18.hs.sort <- sort(net_18.hs, decreasing = TRUE)
net_18.hs.top5 <- head(net_18.hs.sort, n = 5)
```

### Eigenvector centrality

```{r network metrics 1}
ggplot(eigen.15.top10,aes(x=sqs,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Eigenvector centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2015 & 2016 (pre-Irma)")+
  geom_hline(yintercept=0.7885872,color="#781C6D")

ggplot(eigen.17.top10,aes(x=sqs,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Eigenvector centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2017 (Irma)")+
  geom_hline(yintercept=0.7885872,color="#781C6D")+
  geom_hline(yintercept=0.7140983,color="#AE305C")

ggplot(eigen.18.top10,aes(x=sqs,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Eigenvector centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2018 (post-Irma)")+
  geom_hline(yintercept=0.7140983,color="#AE305C")
```

### Betweenness centrality

```{r network networks 2}
btwn.15.tosort <- data.frame(betweenness(net_15))
btwn.15.tosort$vector <- btwn.15.tosort$betweenness.net_15.
btwn.15.sorted <- btwn.15.tosort[order(-btwn.15.tosort$vector),]
btwn.15.sorted$sqs <- rownames(btwn.15.sorted)
btwn.15.top10 <- btwn.15.sorted[1:10,]
sqs_order <- btwn.15.top10$sqs
btwn.15.top10$sqs <- factor(btwn.15.top10$sqs,levels=sqs_order)

btwn.17.tosort <- data.frame(betweenness(net_17))
btwn.17.tosort$vector <- btwn.17.tosort$betweenness.net_17.
btwn.17.sorted <- btwn.17.tosort[order(-btwn.17.tosort$vector),]
btwn.17.sorted$sqs <- rownames(btwn.17.sorted)
btwn.17.top10 <- btwn.17.sorted[1:10,]
sqs_order <- btwn.17.top10$sqs
btwn.17.top10$sqs <- factor(btwn.17.top10$sqs,levels=sqs_order)

btwn.18.tosort <- data.frame(betweenness(net_18))
btwn.18.tosort$vector <- btwn.18.tosort$betweenness.net_18.
btwn.18.sorted <- btwn.18.tosort[order(-btwn.18.tosort$vector),]
btwn.18.sorted$sqs <- rownames(btwn.18.sorted)
btwn.18.top10 <- btwn.18.sorted[1:10,]
sqs_order <- btwn.18.top10$sqs
btwn.18.top10$sqs <- factor(btwn.18.top10$sqs,levels=sqs_order)

ggplot(btwn.15.top10,aes(x=sqs,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Betweenness centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2015 & 2016 (pre-Irma)")

ggplot(btwn.17.top10,aes(x=sqs,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Betweenness centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2017 (Irma)")

ggplot(btwn.18.top10,aes(x=sqs,y=vector))+
  geom_bar(stat="identity")+
  theme(axis.text.x=element_text(angle=90,hjust=1))+
  ylab("Betweenness centrality")+
  xlab("Bacterial sequence")+
  ggtitle("2018 (post-Irma)")
```





