col.ps.rad.lk1.m$time_zone <- paste(col.ps.rad.lk1.m$zone,"-",col.ps.rad.lk1.m$time)
col.ps.rad.lk1.m$time_zone <- factor(col.ps.rad.lk1.m$time_zone,levels=c("In - Pre","In - Irma","In - Post","Off - Pre","Off - Irma","Off - Post"))
ms.rad.lk1 <- plot_microshades(col.ps.rad.lk1.m, col.ps.rad.lk1.c)+
facet_wrap(~time_zone,nrow=2,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Lower Keys 1 Srad")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
#theme(axis.text.x=element_text(angle=45,hjust=1))
ms.rad.lk1
col.ps.rad.lk1.c.new <- color_reassign(col.ps.rad.lk1.c,
group_assignment = c("A","B","C","D"),
color_assignment = c("micro_cvd_gray","micro_cvd_blue","micro_cvd_green","micro_cvd_orange"),group_level="Clade")
col.ps.rad.lk1.c.new <- color_reassign(col.ps.rad.lk1.c,
group_assignment = c("A","B","C","D"),
color_assignment = c("micro_cvd_gray","micro_cvd_blue","micro_cvd_green","micro_cvd_orange"),group_level="Clade")
ms.rad.lk1 <- plot_microshades(col.ps.rad.lk1.m, col.ps.rad.lk1.c.new)+
facet_wrap(~time_zone,nrow=2,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Lower Keys 1 SRAD")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
#theme(axis.text.x=element_text(angle=45,hjust=1))
ms.rad.lk1
## UK1 ##
mdf.ps.rad.uk1 <- prep_mdf(ps.rad.uk1,subgroup_level="Majority_ITS2_sequence")
# Create a color object for the specified data
col.ps.rad.uk1 <- create_color_dfs(mdf.ps.rad.uk1,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("B","D"),cvd=TRUE)
View(mdf.ps.rad.uk1)
# Create a color object for the specified data
col.ps.rad.uk1 <- create_color_dfs(mdf.ps.rad.uk1,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("A","B","C"),cvd=TRUE)
# Extract
col.ps.rad.uk1.m <- col.ps.rad.uk1$mdf
col.ps.rad.uk1.c <- col.ps.rad.uk1$cdf
col.ps.rad.uk1.m$zone <- sub("I","In",col.ps.rad.uk1.m$zone)
col.ps.rad.uk1.m$zone <- sub("O","Off",col.ps.rad.uk1.m$zone)
col.ps.rad.uk1.m$time_zone <- paste(col.ps.rad.uk1.m$zone,"-",col.ps.rad.uk1.m$time)
col.ps.rad.uk1.m$time_zone <- factor(col.ps.rad.uk1.m$time_zone,levels=c("In - Pre","In - Irma","In - Post","Off - Pre","Off - Irma","Off - Post"))
col.ps.rad.uk1.c.new <- color_reassign(col.ps.rad.uk1.c,
group_assignment = c("A","B","C"),
color_assignment = c("micro_cvd_grey","micro_cvd_blue","micro_cvd_green"),group_level="Clade")
col.ps.rad.uk1.c.new <- color_reassign(col.ps.rad.uk1.c,
group_assignment = c("A","B","C"),
color_assignment = c("micro_cvd_gray","micro_cvd_blue","micro_cvd_green"),group_level="Clade")
ms.rad.uk1 <- plot_microshades(col.ps.rad.uk1.m, col.ps.rad.uk1.c.new)+
facet_wrap(~time_zone,nrow=2,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Upper Keys 1 Srad")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
#theme(axis.text.x=element_text(angle=45,hjust=1))
ms.rad.uk1
View(mdf.ps.sid.uk2)
View(mdf.ps.rad.uk1)
#type_groups <- c(unique(mdf.ps.rad$Clade))
mdf.ps.rad.uk1 <- subset(mdf.ps.rad.uk1,Sample!="UK1-O_000_srad_2017")
# Create a color object for the specified data
col.ps.rad.uk1 <- create_color_dfs(mdf.ps.rad.uk1,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("A","B","C"),cvd=TRUE)
# Extract
col.ps.rad.uk1.m <- col.ps.rad.uk1$mdf
col.ps.rad.uk1.c <- col.ps.rad.uk1$cdf
col.ps.rad.uk1.m$zone <- sub("I","In",col.ps.rad.uk1.m$zone)
col.ps.rad.uk1.m$zone <- sub("O","Off",col.ps.rad.uk1.m$zone)
col.ps.rad.uk1.m$time_zone <- paste(col.ps.rad.uk1.m$zone,"-",col.ps.rad.uk1.m$time)
col.ps.rad.uk1.m$time_zone <- factor(col.ps.rad.uk1.m$time_zone,levels=c("In - Pre","In - Irma","In - Post","Off - Pre","Off - Irma","Off - Post"))
col.ps.rad.uk1.c.new <- color_reassign(col.ps.rad.uk1.c,
group_assignment = c("A","B","C"),
color_assignment = c("micro_cvd_gray","micro_cvd_blue","micro_cvd_green"),group_level="Clade")
ms.rad.uk1 <- plot_microshades(col.ps.rad.uk1.m, col.ps.rad.uk1.c.new)+
facet_wrap(~time_zone,nrow=2,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Upper Keys 1 Srad")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
#theme(axis.text.x=element_text(angle=45,hjust=1))
ms.rad.uk1
## uk2 ##
mdf.ps.rad.uk2 <- prep_mdf(ps.rad.uk2,subgroup_level="Majority_ITS2_sequence")
# Create a color object for the specified data
col.ps.rad.uk2 <- create_color_dfs(mdf.ps.rad.uk2,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("B","C","D"),cvd=TRUE)
View(mdf.ps.rad.uk2)
# Create a color object for the specified data
col.ps.rad.uk2 <- create_color_dfs(mdf.ps.rad.uk2,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("B","C","D"),cvd=TRUE)
# Extract
col.ps.rad.uk2.m <- col.ps.rad.uk2$mdf
# Create a color object for the specified data
col.ps.rad.uk2 <- create_color_dfs(mdf.ps.rad.uk2,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("A","B","C","D"),cvd=TRUE)
# Create a color object for the specified data
col.ps.rad.uk2 <- create_color_dfs(mdf.ps.rad.uk2,group_level="Clade",subgroup_level="Majority_ITS2_sequence",selected_groups=c("B","C","D"),cvd=TRUE)
# Extract
col.ps.rad.uk2.m <- col.ps.rad.uk2$mdf
col.ps.rad.uk2.c <- col.ps.rad.uk2$cdf
col.ps.rad.uk2.m$zone <- sub("I","In",col.ps.rad.uk2.m$zone)
col.ps.rad.uk2.m$zone <- sub("O","Off",col.ps.rad.uk2.m$zone)
col.ps.rad.uk2.m$time_zone <- paste(col.ps.rad.uk2.m$zone,"-",col.ps.rad.uk2.m$time)
col.ps.rad.uk2.m$time_zone <- factor(col.ps.rad.uk2.m$time_zone,levels=c("In - Pre","In - Irma","In - Post","Off - Pre","Off - Irma","Off - Post"))
col.ps.rad.uk2.c.new <- color_reassign(col.ps.rad.uk2.c,
group_assignment = c("B","C","D"),
color_assignment = c("micro_cvd_blue","micro_cvd_green","micro_cvd_orange"),group_level="Clade")
ms.rad.uk2 <- plot_microshades(col.ps.rad.uk2.m, col.ps.rad.uk2.c.new)+
facet_wrap(~time_zone,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Upper Keys 2 Srad")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
#theme(axis.text.x=element_text(angle=45,hjust=1))
ms.rad.uk2
ggarrange(ms.rad.uk2,ms.rad.uk1,ms.rad.lk1,nrow=3,ncol=1,labels=c("(a)","(b)","(c)"))
ms.rad.uk1 <- plot_microshades(col.ps.rad.uk1.m, col.ps.rad.uk1.c.new)+
facet_wrap(~time_zone,nrow=2,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Upper Keys 1 SRAD")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
ms.rad.uk2 <- plot_microshades(col.ps.rad.uk2.m, col.ps.rad.uk2.c.new)+
facet_wrap(~time_zone,scales="free_x")+
theme_cowplot()+
theme(axis.text.x=element_blank())+
ggtitle("Upper Keys 2 SRAD")+
guides(color=guide_legend("Majority ITS2 sequence"),fill=guide_legend("Majority ITS2 sequence"))
ggarrange(ms.rad.uk2,ms.rad.uk1,ms.rad.lk1,nrow=3,ncol=1,labels=c("(a)","(b)","(c)"))
ggsave("ms.plot.rad.pdf",height=9,width=6.5)
otu.sid <- as.data.frame(ps.sid.no0@otu_table)
otu.sid[otu.sid > 0] <- 1 #converts from abundance to P/A
head(otu.sid)
rowSums(otu.sid)
ps.sid.pa <- ps.sid.no0
otu.sid <- as.data.frame(ps.sid.pa@otu_table)
otu.sid[otu.sid > 0] <- 1 #converts from abundance to P/A
head(otu.sid)
#head(otu.sid)
#rowSums(otu.sid)
ps.sid.pa@otu_table <- otu.sid
#head(otu.sid)
#rowSums(otu.sid)
ps.sid.pa@otu_table <- otu_table(otu.sid)
#head(otu.sid)
#rowSums(otu.sid)
ps.sid.pa@otu_table <- otu_table(otu.sid,taxa_are_rows = F)
?merge_samples
ps.sid.pa.site <- merge_samples(ps.sid.pa,"site")
View(ps.sid.pa.site)
ps.sid.pa.site@otu_table
View(otu.sid)
ps.sid.pa.sz <- merge_samples(ps.sid.pa,"site_zone")
View(ps.sid.pa.sz)
ps.sid.pa.sz@otu_table
View(otu.sid)
otu.sid$sum <- rowSums(otu.sid)
rich.df <- c(row.names(otu.sid),otu.sid$sum)
rich.df <- data.frame(c(row.names(otu.sid),otu.sid$sum))
View(rich.df)
rich.df <- data.frame(row.names(otu.sid),otu.sid$sum)
View(rich.df)
View(ps.sid.uk2)
ps.sid.uk2@sam_data
colnames(rich.df) <- c("full_sample","rich")
#ps.sid.pa <- ps.sid.no0
samdf.sid <- as.data.frame(ps.sid.no0@sam_data)
View(samdf.sid)
samdf.sid.rich <- merge(samdf.sid,rich.df)
samdf.sid.rich <- merge(samdf.sid,rich.df,by="full_sample")
#ps.sid.pa <- ps.sid.no0
samdf.sid <- data.frame(ps.sid.no0@sam_data)
#ps.sid.pa <- ps.sid.no0
samdf.sid <- data.frame(ps.sid.no0@sam_data)
otu.sid <- data.frame(ps.sid.no0@otu_table)
otu.sid[otu.sid > 0] <- 1 #converts from abundance to P/A
otu.sid$sum <- rowSums(otu.sid)
rich.df <- data.frame(row.names(otu.sid),otu.sid$sum)
colnames(rich.df) <- c("full_sample","rich")
samdf.sid.rich <- merge(samdf.sid,rich.df,by="full_sample")
View(samdf.sid.rich)
ggplot(samdf.sid.rich,aes(x=zone,y=rich))+
geom_boxplot()+
facet_wrap(site~time)
ggplot(samdf.sid.rich,aes(x=zone,y=rich))+
geom_boxplot()+
facet_wrap(site~time,scales="free")
ggplot(samdf.sid.rich,aes(x=zone,y=rich))+
geom_boxplot()+
geom_jitter()+
facet_wrap(site~time,scales="free")
?summarySE
library("Rmisc")
?summarySE
samdf.sid.rich.se <- summarySE(samdf.sid.rich,measurevar="rich",groupvars=c("zone","time","site"))
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_point()+
geom_jitter(samdf.sid.rich)+
facet_wrap(site~time,scales="free")
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_point()+
geom_jitter(samdf.sid.rich,aes(x=zone,y=rich))+
facet_wrap(site~time,scales="free")
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_point()+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich))+
facet_wrap(site~time,scales="free")
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_point(size=2)+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich),alpha=0.5)+
facet_wrap(site~time,scales="free")
View(samdf.sid.rich.se)
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se))+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich),alpha=0.5)+
facet_wrap(site~time,scales="free")
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)+
facet_wrap(site~time,scales="free")
samdf.sid.rich2.se <- summarySE(samdf.sid.rich,measurevar="rich",groupvars=c("zone","time"))
ggplot(samdf.sid.rich2.se,aes(x=zone,y=rich))+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)+
facet_wrap(site~time,scales="free")
ggplot(samdf.sid.rich2.se,aes(x=zone,y=rich))+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)+
facet_wrap(~time,scales="free")
ggplot(samdf.sid.rich2.se,aes(x=zone,y=rich))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)
samdf.sid.rich$time <- factor(samdf.sid.rich$time,levels=c("Pre","Irma","Post"))
samdf.sid.rich2.se <- summarySE(samdf.sid.rich,measurevar="rich",groupvars=c("zone","time"))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_dodge())+
geom_point(size=2,position=position_dodge())+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge())
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_dodge(0.2))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5)+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitterdodge(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5)+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
position_jitterdodge(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5)+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_jitterdodge())+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_jitterdodge(0.2))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_jitter(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_jitterdodge(dodge.width=0.2))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_jitterdodge(dodge.width=0.2))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone),alpha=0.5,position=position_jitterdodge())+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
?position_jitterdodge()
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5,position=position_jitterdodge())+
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5,position=position_jitterdodge()))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5,position=position_jitterdodge()))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5)+
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sidx.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich2.se,aes(x=time,y=rich,color=zone))+
geom_point(data=samdf.sid.rich,aes(x=time,y=rich,color=zone,alpha=0.5))+
geom_point(size=2,position=position_dodge(0.2))+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.1,position=position_dodge(0.2))
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_point()
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_jitter()
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_point()
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_point(position=position_jitterdodge())
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_jitter(position=position_jitterdodge())
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_jitter(position=position_dodge())
ggplot(samdf.sid.rich,aes(x=time,y=rich,fill=zone))+
geom_jitter(position=position_dodge())
ggplot(samdf.sid.rich,aes(x=time,y=rich,fill=zone))+
geom_point(position=position_jitterdodge())
ggplot(samdf.sid.rich,aes(x=time,y=rich,fill=zone))+
geom_point(position=position_jitterdodge(dodge.width=0.9))
ggplot(samdf.sid.rich.se,aes(x=zone,y=rich))+
geom_jitter(data=samdf.sid.rich,aes(x=zone,y=rich),alpha=0.5)+
geom_point(size=2)+
geom_errorbar(aes(ymax=rich+se,ymin=rich-se),width=0.2)+
facet_wrap(site~time,scales="free")
View(samdf.sid.rich)
ggplot(samdf.sid.rich,aes(x=time,y=rich,fill=zone))+
geom_violin()
ggplot(samdf.sid.rich,aes(x=time,y=rich,fill=zone))+
geom_density()
ggplot(samdf.sid.rich,aes(x=time,y=rich,fill=zone))+
geom_dotplot()
ggplot(samdf.sid.rich,aes(x=time,y=rich))+
geom_dotplot()
ggplot(samdf.sid.rich,aes(x=time,y=rich,group=zone))+
geom_dotplot()
str(samdf.sid.rich)
ggplot(samdf.sid.rich,aes(x=time,y=rich,group=zone))+
geom_dotplot(binaxis="y")
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_dotplot(binaxis="y")
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_boxplot()
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_boxplot()+
geom_jitter()
ggplot(samdf.sid.rich,aes(x=time,y=rich,color=zone))+
geom_boxplot()+
geom_point(position=position_jitterdodge())
new.rich.df <- samdf.sid.rich %>%
new.rich.df <- samdf.sid.rich %>%
group_by(site,zone,time) %>%
summarise(abun=sum(rich))
View(new.rich.df)
library("dplyr")
new.rich.df <- samdf.sid.rich %>%
group_by(site,zone,time) %>%
summarise(abun=sum(rich))
View(new.rich.df)
new.rich.df <- samdf.sid.rich %>%
group_by(site,zone,time,rich) %>%
summarise(abun=sum(rich))
View(new.rich.df)
samdf.sid.rich.grp <- samdf.sid.rich %>%
group_by(site,zone,time,rich) %>%
summarise(abun=sum(rich))
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun))+
geom_point()
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point()
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge())
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge(0.5))
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_wrap(~site)
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_wrap(site~.)
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_grid(~site)
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_grid(site~.)
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=abun,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_grid(~site)
samdf.sid.rich.grp <- samdf.sid.rich %>%
group_by(site,zone,time,rich) %>%
summarise(abun=sum(rich)) %>%
mutate(perc=abun/sum(abun))
View(samdf.sid.rich.grp)
samdf.sid.rich %>%
group_by(site,zone,time) %>%
table()
samdf.sid.rich %>%
group_by(site,zone,time) %>%
count()
samdf.sid.rich.grp <- samdf.sid.rich %>%
group_by(site,zone,time,rich) %>%
summarise(abun=sum(rich)) %>%
mutate(perc=abun/sum(abun))
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=perc,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_grid(~site)
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich))+
geom_bar()
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich))+
geom_bar(stat="identity")
ggplot(data, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")
samdf.sid.rich.grp$rich <- as.factor(samdf.sid.rich.grp$rich)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)
ggplot(samdf.sid.rich.grp, aes(fill=-rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)
ggplot(samdf.sid.rich.grp, aes(fill=rev(rich), y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)
samdf.sid.rich.grp$rich <- fct_rev(samdf.sid.rich.grp$rich)
library("tidyverse")
samdf.sid.rich.grp$rich <- fct_rev(samdf.sid.rich.grp$rich)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("white","grey","darkgrey","black"))
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","darkgrey","grey","white"))
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","white"))
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","white"))+
theme_cowplot()
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
samdf.sid.rich.grp$perc2 <- samdf.sid.rich.grp$perc*100
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich,size=perc,color=zone))+
geom_point(position=position_dodge(0.5))+
facet_grid(~site)
ggplot(samdf.sid.rich.grp,aes(x=time,y=rich))+
geom_bar(stat="identity")
samdf.sid.rich.grp$rich <- as.factor(samdf.sid.rich.grp$rich)
samdf.sid.rich.grp$rich <- as.factor(samdf.sid.rich.grp$rich)
samdf.sid.rich.grp$rich <- fct_rev(samdf.sid.rich.grp$rich)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc2, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc2, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=perc2, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
View(samdf.sid.rich.grp)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time))+
geom_bar(position="dodge", stat="identity")
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time))+
geom_bar(position="stack", stat="identity")
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time))+
geom_bar(position="fill", stat="identity")
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
samdf.sid.rich.grp$rich <- as.factor(samdf.sid.rich.grp$rich)
samdf.sid.rich.grp$rich <- fct_rev(samdf.sid.rich.grp$rich)
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time)) +
geom_bar(position="fill", stat="identity")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time)) +
geom_bar(position="fill", stat="identity",color="black")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","grey90"))+
theme_cowplot()
ggplot(samdf.sid.rich.grp, aes(fill=rich, y=abun, x=time)) +
geom_bar(position="fill", stat="identity",color="black")+
facet_wrap(site~zone)+
scale_fill_manual(values=c("black","grey40","grey","white"))+
theme_cowplot()
