#install.packages("remotes")
remotes::install_github("Russel88/MicEco")
install.packages("remotes")
remotes::install_github("Russel88/MicEco")
#install.packages("remotes")
#remotes::install_github("Russel88/MicEco")
library("MicEco")
samdf.trim <- data.frame(ps.trim@sam_data)
#install.packages("TMB")
#install.packages("remotes")
#remotes::install_github("glmmTMB/glmmTMB/glmmTMB")
library("glmmTMB")
##trying to update this stupid package
install.packages('TMB', type = 'source') #didn't work on home laptop
install.packages("TMB", type = "source")
##trying to update this stupid package
install.packages('TMB') #didn't work on home laptop
#install.packages("TMB")
remotes::install_github("glmmTMB/glmmTMB/glmmTMB")
#install.packages("TMB")
#remotes::install_github("glmmTMB/glmmTMB/glmmTMB")
library("glmmTMB")
##trying to update this stupid package
install.packages('TMB',source=TRUE) #didn't work on home laptop
install.packages("TMB", source = TRUE)
#install.packages("TMB")
#remotes::install_github("glmmTMB/glmmTMB/glmmTMB")
library("glmmTMB")
#install.packages("TMB")
remotes::install_github("glmmTMB/glmmTMB/glmmTMB")
library("glmmTMB")
##trying to update this stupid package
#install.packages('TMB',source=TRUE) #didn't work on home laptop
#install.packages("TMB")
#remotes::install_github("glmmTMB/glmmTMB/glmmTMB")
library("glmmTMB")
setwd("~/nicfall@bu.edu - Google Drive/My Drive/Flirma/flirma_networks")
install.packages("gitcreds")
library(gitcreds)
gitcreds_set()
setwd("~/Library/CloudStorage/GoogleDrive-nicfall@bu.edu/My Drive/Flirma/flirma_networks/fl_env")
#install.packages("sf")
library(sf)
#install.packages("maps")
library(maps)
#install.packages("mapdata")
library(mapdata)
#install.packages("maptools")
library(maptools)
install.packages("maps")
install.packages("mapdata")
#install.packages("mapdata")
library(mapdata)
install.packages("maptools")
#install.packages("maptools")
library(maptools)
library(ggplot2)
#install.packages("rnaturalearth")
library("rnaturalearth")
install.packages("rnaturalearth")
#install.packages("rnaturalearth")
library("rnaturalearth")
install.packages("rnaturalearthdata")
#install.packages("rnaturalearthdata")
library("rnaturalearthdata")
library(cowplot)
fname <- "./zipfolder/coastline_highest_resolution.shp"
fname
flkeys <- st_read(fname)
#coordinates for points:
sites.pts <- read.csv("fl_latlon_nobiscayne.csv")
#coordinates for damage assessment:
sites.dmg <- read.csv("NCCOS download - dmg_impacts.csv")
ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=sites.dmg,aes(x=Longitude,y=Latitude),size=1,alpha=0.5)+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=reef_zone))+
scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone")+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
xlab("")+
ylab("")
#install.packages("tmap")
library(tmap)
install.packages("tmap")
#install.packages("tmap")
library(tmap)
qtm(flkeys)
dmg <- read.csv("dmg_mixed_cleaned.csv")
gg.map.dmg <- ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=dmg,aes(x=Longitude,y=Latitude,color=score),alpha=0.8,size=2,pch=15)+
scale_color_gradientn(colours=hcl.colors(12,"Peach",rev=T),limits=c(1,3),name="Damage")+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone),size=3)+
#scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
#scale_size_continuous(limits=c(1.00,3.00))+ ,size=score
scale_shape_manual(values=c(21,23),name="Reef zone",labels=c("Inshore","Offshore"))+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
xlab("")+
ylab("")+
ggtitle("Damage score (NCCOS & affiliates)")
gg.map.dmg
dmg.pts <- dmg[,c("Latitude","Longitude")]
dmg.pts <- dmg[,c("Latitude","Longitude")]
colnames(dmg.pts) <- c("lat","lon")
sites <- sites.pts[,c("lat","lon")]
points <- rbind(dmg.pts,sites)
points.dist <- dist(points)
points.mat <- as.matrix(points.dist)
mat.1 <- data.frame(points.mat[60,])
order(mat.1)
??order
View(mat.1)
order(mat.1)
View(points)
View(dmg)
View(dmg.pts)
View(sites)
View(points.mat)
points.mat[60,]
View(dmg.pts)
View(mat.1)
order(mat.1$V1)
order(mat.1[,1])
##5 closest points
# pts.1 <- rbind(dmg[51,],dmg[42,],dmg[46,],dmg[38,],dmg[40,])
# pts.1$site <- rep("site1",5)
##3 closest points
pts.1 <- rbind(dmg[51,],dmg[42,],dmg[46,])
pts.1$site <- rep("site1",3)
##row 61 = second site, Rocky Top, offshore
mat.2 <- data.frame(points.mat[61,])
order(mat.2)
order(mat.2[,1])
##5 closest points
# pts.2 <- rbind(dmg[57,],dmg[12,],dmg[13,],dmg[11,],dmg[56,])
# pts.2$site <- rep("site2",5)
##3 closest points
pts.2 <- rbind(dmg[57,],dmg[12,],dmg[13,])
pts.2$site <- rep("site2",3)
order(mat.3[,1])
##row 62 = third site, Cheeca Rocks, inshore
mat.3 <- data.frame(points.mat[62,])
order(mat.3[,1])
##5 closest points
# pts.3 <- rbind(dmg[57,],dmg[12,],dmg[13,],dmg[11,],dmg[18,])
# pts.3$site <- rep("site3",5)
##3 closest points
pts.3 <- rbind(dmg[57,],dmg[12,],dmg[13,])
pts.3$site <- rep("site3",3)
##row 63 = fourth site, Carysfort, offshore
mat.4 <- data.frame(points.mat[63,])
order(mat.4)
order(mat.4[,1])
##5 closest points
# pts.4 <- rbind(dmg[59,],dmg[7,],dmg[1,],dmg[5,],dmg[4,])
# pts.4$site <- rep("site4",5)
##3 closest points
pts.4 <- rbind(dmg[59,],dmg[7,],dmg[1,])
pts.4$site <- rep("site4",3)
##row 64 = fifth site, Basin hill, inshore
mat.5 <- data.frame(points.mat[64,])
order(mat.5[,1])
##row 65 = sixth site, W. Washerwoman, inshore
mat.6 <- data.frame(points.mat[65,])
order(mat.6[,1])
##5 closest points
# pts.6 <- rbind(dmg[40,],dmg[38,],dmg[43,],dmg[42,],dmg[44,])
# pts.6$site <- rep("site6",5)
##3 closest points
pts.6 <- rbind(dmg[40,],dmg[38,],dmg[43,])
pts.6$site <- rep("site6",3)
closest.pts <- rbind(pts.1,pts.2,pts.3,pts.4,pts.6)
ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=closest.pts,aes(x=Longitude,y=Latitude,color=score,size=score,alpha=0.5))+
scale_color_gradient(low="blue",high="yellow")+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=reef_zone))+
scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone")+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
xlab("")+
ylab("")
library("dplyr")
closer <- closest.pts %>%
group_by(site) %>%
mutate(site.mean=mean(score))
ggplot(closest.pts,aes(x=site,y=score))+
geom_boxplot()+
geom_point()
##closest average of 3 points:
sites.pts$score <- c(1.33,1.67,1.67,1.33,1.33,1.57)
closer
#install.packages("ggrepel")
library("ggrepel")
gg.map.dmg.avg <- ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=score),color="black",size=3)+
scale_fill_gradientn(colours=hcl.colors(12,"Peach",rev=T),limits=c(1,3),name="Damage")+
#geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone),size=3)+
#scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone",labels=c("Inshore","Offshore"))+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
scale_size_continuous(limits=c(1,3))+
xlab("")+
ylab("")+
ggtitle("Mean damage score of five nearest sites")+
geom_label_repel(data=sites.pts,aes(x=lon,y=lat,label=score))
gg.map.dmg.avg
ggarrange(gg.map.dmg,gg.map.dmg.avg,nrow=2,ncol=1,labels=c("(a)","(b)"),common.legend=T,legend="right")
library("ggpubr")
ggarrange(gg.map.dmg,gg.map.dmg.avg,nrow=2,ncol=1,labels=c("(a)","(b)"),common.legend=T,legend="right")
gg.map.dmg.avg <- ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=score),color="black",size=3)+
scale_fill_gradientn(colours=hcl.colors(12,"Peach",rev=T),limits=c(1,3),name="Damage")+
#geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone),size=3)+
#scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone",labels=c("Inshore","Offshore"))+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
scale_size_continuous(limits=c(1,3))+
xlab("")+
ylab("")+
ggtitle("Mean damage score of three nearest sites")+
geom_label_repel(data=sites.pts,aes(x=lon,y=lat,label=score))
gg.map.dmg.avg
##5 closest points
pts.1 <- rbind(dmg[51,],dmg[42,],dmg[46,],dmg[38,],dmg[40,])
pts.1$site <- rep("site1",5)
##5 closest points
pts.2 <- rbind(dmg[57,],dmg[12,],dmg[13,],dmg[11,],dmg[56,])
pts.2$site <- rep("site2",5)
##5 closest points
pts.3 <- rbind(dmg[57,],dmg[12,],dmg[13,],dmg[11,],dmg[18,])
pts.3$site <- rep("site3",5)
##5 closest points
pts.4 <- rbind(dmg[59,],dmg[7,],dmg[1,],dmg[5,],dmg[4,])
pts.4$site <- rep("site4",5)
order(mat.5[,1])
##5 closest points
pts.4 <- rbind(dmg[59,],dmg[7,],dmg[1,],dmg[5,],dmg[4,])
pts.4$site <- rep("site4",5)
##5 closest points
pts.6 <- rbind(dmg[40,],dmg[38,],dmg[43,],dmg[42,],dmg[44,])
pts.6$site <- rep("site6",5)
closest.pts <- rbind(pts.1,pts.2,pts.3,pts.4,pts.6)
ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=closest.pts,aes(x=Longitude,y=Latitude,color=score,size=score,alpha=0.5))+
scale_color_gradient(low="blue",high="yellow")+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=reef_zone))+
scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone")+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
xlab("")+
ylab("")
library("dplyr")
closer <- closest.pts %>%
group_by(site) %>%
mutate(site.mean=mean(score))
ggplot(closest.pts,aes(x=site,y=score))+
geom_boxplot()+
geom_point()
closer
closest.pts
closer$site.mean
##closest average of 5 points:
sites.pts$score <- c(1.34,1.66,2.00,1.3,1.3,1.56)
#install.packages("ggrepel")
library("ggrepel")
gg.map.dmg.avg <- ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=score),color="black",size=3)+
scale_fill_gradientn(colours=hcl.colors(12,"Peach",rev=T),limits=c(1,3),name="Damage")+
#geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone),size=3)+
#scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone",labels=c("Inshore","Offshore"))+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
scale_size_continuous(limits=c(1,3))+
xlab("")+
ylab("")+
ggtitle("Mean damage score of three nearest sites")+
geom_label_repel(data=sites.pts,aes(x=lon,y=lat,label=score))
gg.map.dmg.avg
gg.map.dmg.avg <- ggplot() +
geom_sf(data = flkeys)+
theme_cowplot()+
geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone,fill=score),color="black",size=3)+
scale_fill_gradientn(colours=hcl.colors(12,"Peach",rev=T),limits=c(1,3),name="Damage")+
#geom_point(data=sites.pts,aes(x=lon,y=lat,shape=reef_zone),size=3)+
#scale_fill_manual(name="Reef zone",values=c("#3BBA76","#453882"))+
scale_shape_manual(values=c(21,23),name="Reef zone",labels=c("Inshore","Offshore"))+
# annotate("point", x = -82, y = 25, colour = "red", size = 4)+
scale_size_continuous(limits=c(1,3))+
xlab("")+
ylab("")+
ggtitle("Mean damage score of five nearest points")+
geom_label_repel(data=sites.pts,aes(x=lon,y=lat,label=score))
gg.map.dmg.avg
ggarrange(gg.map.dmg,gg.map.dmg.avg,nrow=2,ncol=1,labels=c("(a)","(b)"),common.legend=T,legend="right")
